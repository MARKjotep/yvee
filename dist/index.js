var Ft=function(t,n,r,i){var o=arguments.length,e=o<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,r):i,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")e=Reflect.decorate(t,n,r,i);else for(var u=t.length-1;u>=0;u--)if(s=t[u])e=(o<3?s(e):o>3?s(n,r,e):s(n,r))||e;return o>3&&e&&Object.defineProperty(n,r,e),e};var Zt=(t,n)=>{if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,n)};var x=(t)=>typeof t==="function";var R=(t)=>{return!isNaN(parseFloat(t))&&isFinite(t)},at=(t)=>{return typeof t==="object"&&t!==null&&!Array.isArray(t)},k=(t)=>{return typeof t==="object"&&t!==null&&Object.getPrototypeOf(t)===Object.prototype};var v=(t)=>typeof t==="boolean",tt=(t)=>typeof t==="string",a=(t)=>Array.isArray(t),w=(t)=>typeof t==="object",It=(t)=>typeof t==="number",C=(t)=>t===null,Xt=(t)=>typeof t==="undefined",Jt=(t)=>{return Number.isInteger(Number(t))},gt=typeof window!=="undefined",c=typeof window==="undefined";function nt(t,n){h(n).forEach(([r,i])=>{Ut(t,r,{value:i,writable:!1,configurable:!1,enumerable:!0})})}class H{static set p(t){if(Array.isArray(t))console.log(...t);else console.log(t)}}class d{_c=0;_id="";constructor(t){if(this._c=0,this._id=t??p(5),t?.includes("-")){let[n,r]=[t.split("-").slice(0,-1).join("-"),t.split("-").slice(-1)[0]];this._id=n,this._c=R(r)?parseInt(r):0}}get id(){return this._id+"-"+this._c}get mid(){return this._id+"-"+ ++this._c}}var vn=new RegExp(/(\d+)(\d*)/,"m"),dn=(t)=>Array.from({length:t},(n,r)=>r),pn="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Tn="abcdefghijklmnopqrstuvwxyz",bn=dn(10).join("");var E=(t)=>JSON.stringify(t),Qt=(t)=>{return JSON.parse(t)},S=(t)=>{if(t.startsWith("webkit"))t="-"+t;return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},p=(t)=>{let n=pn+Tn;return Array.from({length:t},(r,i)=>n+(i?bn:"")).reduce((r,i)=>{return r+=i.charAt(Math.floor(Math.random()*i.length))},"")};class f extends Map{obj(t){t&&h(t).forEach(([n,r])=>this.set(n,r))}map(t){t.forEach((n,r)=>{if(n instanceof f)this.set(r,n);else if(a(n)){if(this.lacks(r))this.set(r,[]);this.get(r).push(...n)}else if(w(n))this.ass(r,n);else this.set(r,n)})}ass(t,n){if(!this.has(t))this.set(t,{});T(this.get(t),n)}lacks(t){return!this.has(t)}init(t,n){return this.has(t)?this.get(t):this.set(t,n).get(t)}}var{values:y,keys:J,entries:h}=Object;var{hasOwn:Yt,freeze:Wt,defineProperty:Ut,assign:T}=Object,$=(t)=>{return Object.keys(t).length},rt=(t,n)=>{if(!n.has(t))n.set(t,new f);return n.get(t)},G=(t,n)=>{if(!n.has(t))n.set(t,[]);return n.get(t)},lt=(t,n)=>{let r={added:{},removed:{},modified:{}},i=J(t),o=J(n);for(let e of o){let s=t[e],u=n[e];if(!(e in t))r.added[e]=u;else if(a(s)&&a(u)){if(E(s)!==E(u))r.modified[e]={old:s,new:u}}else if(w(s)&&w(u)&&!C(s)&&!C(u)){let m=lt(s,u);if($(m.added)||$(m.removed)||$(m.modified))r.modified[e]={old:s,new:u}}else if(s!==u)r.modified[e]={old:s,new:u}}for(let e of i)if(!(e in n))r.removed[e]=t[e];return r};function Bt(t,n){if(t.size!==n.size)return!1;for(let r of t)if(!n.has(r))return!1;return!0}var Ct=(t)=>{return y(t).some((n)=>{return $(n)})};function Gt(t){let n;return class extends t{constructor(...r){if(n)return n;super(...r);Wt(this),n=this}}}var F=(t,n)=>{return{name:t,content:n}},yn=(t,n)=>{return{property:t,content:n}},xn=(t,n)=>{return{"http-equiv":t,content:n}};class it{metas=[];constructor(t){t&&this.metas.push(F("description",t))}author(t){return this.meta=F("author",t),this}charset(t){return this.meta={charset:t},this}keywords(...t){return this.meta=F("keywords",t.join(", ")),this}viewport(t){let n=h(t).map(([r,i])=>[S(r),String(i)].join("="));return this.meta=F("viewport",n.join(", ")),this}httpEquiv(t){return h(t).forEach(([n,r])=>{this.meta=xn(S(n),String(r))}),this}robots(...t){return this.meta=F("robots",t.join(", ")),this}themeColor(t){return this.meta=F("theme-color",t),this}openGraph(t){return h(t).forEach(([n,r])=>{this.meta=yn("og:"+n,String(r))}),this}twitter(t){return h(t).forEach(([n,r])=>{this.meta=F("twitter:"+n,String(r))}),this}and(t){return this}set meta(t){this.metas.push(t)}}class ct{title;description;base;meta;link;script;css}var En=["charset","name","property","http-equiv"],Pt=(t,n)=>{n.forEach((r)=>{for(let i of En)if(i in r){let o=r[i];t[`${i}_${i==="charset"?"":o}`]=r}})},$n=(t,n)=>{n.forEach((r)=>{if("href"in r){let i=r.href;t[`${i}`]=r}})};class U{_head;idm;constructor(t){this._head=new f(t)}set head(t){h(t).forEach(([n,r])=>{if(n==="title"||n==="base"){if(r!==void 0)this._head.set(n,r);return}if(r instanceof it)return Pt(this._head.init("meta",{}),r.metas);if(!a(r))return;switch(n){case"meta":return Pt(this._head.init("meta",{}),r);case"link":return $n(this._head.init("link",{}),r);case"script":if(r.length){this._head.init(n,[]);let i=r.map((o)=>{if(!o.yid&&this.idm)o.yid="sc"+this.idm.mid;return o});this._head.get(n).push(...i)}return}})}get head(){return this._head}set id(t){this.idm=new d(t)}}var zt=(t)=>{return h(t).reduce((n,[r,i])=>{return n.push(v(i)&&i?r:`${r}="${i}"`),n},[""]).join(" ")},Kt=(t)=>{if(!t)return"";return[...t].reduce((n,[r,i])=>{if(r==="meta"||r==="link")i=y(i);if(tt(i))return n.push(`<${r}>${i}</${r}>`),n;if(!a(i))return n;let o=i.map((e)=>{if(r==="script"){let s={...e};if("yid"in s)return"";let u="";if("importmap"in s)s.type="importmap",u=JSON.stringify(s.importmap),delete s.importmap;else if("body"in s)u=s.body,delete s.body;return`<${r}${zt(s)}>${u}</${r}>`}return`<${r}${zt(e)}>`});return n.push(...o),n},[]).join("")};class dt{lang="en";htmlHead=new f;head;constructor(){this.head=(t={})=>{let n=new U(this.htmlHead);n.head=t,this.htmlHead=n.head}}}var pt=(t)=>{if(c)return;return new Promise((n,r)=>{let i=document.createElement("link");if(t.rel!=="stylesheet")t.rel="stylesheet",t.as="style";h(t).forEach(([o,e])=>{i.setAttribute(o,e)}),i.onload=()=>n(i),i.onerror=()=>r(new Error("Failed to load CSS")),document.head.appendChild(i)})},Nt=(t)=>{return new Promise((n,r)=>{let i=document.createElement("script"),o="";if("importmap"in t)t.type="importmap",o=JSON.stringify(t.importmap),delete t.importmap;else if("body"in t)o=t.body,delete t.body;if(o)i.innerHTML=o;h(t).forEach(([e,s])=>{i.setAttribute(e,s)}),i.onload=()=>n(i),i.onerror=()=>r(new Error("Failed to load Script")),document.head.appendChild(i)})},wn=()=>{let n=document.querySelector("#d-css")?.sheet;if(n)return n;let r=document.createElement("style");return r.id="d-css",document.head.appendChild(r),r.sheet},Hn=(t,n)=>{for(let r=0;r<t.cssRules.length;r++)if(t.cssRules[r].selectorText===n)return!0;return!1},jn=(t)=>Object.entries(t).map(([n,r])=>`${S(n)}: ${r};`).join(" ");function Dn(t,n={}){if(c)return;let r=wn();if(!r)return;if(!Hn(r,t))r.insertRule(`${t} { ${jn(n)} }`,r.cssRules.length)}var Vt=(t,n)=>{let r=n;if(t?.class)r.push(...a(t.class)?t.class:[t.class]);return delete t.class,r.filter((i)=>i)};var Ot=(t,n=!1)=>{if(R(t))return[+t,Jt(t)?"int":"float"];if(n&&/\.\w+$/.test(t))return[t,"file"];if(t==="/")return[t,"-"];if(t.length===36&&t.match(/\-/g)?.length===4)return[t,"uuid"];return[t,"string"]},ot=(t)=>{let n=t.startsWith("/")?t:"/"+t,r=n.match(/(?<=\/)[^/].*?(?=\/|$)/g)??["/"],[i,o]=r.reduce(([e,s],u)=>{if(u.includes("<")){let m=u.match(/(?<=<)[^/].*?(?=>|$)/g);if(m?.length){let[l,b]=m[0].split(":");if(l&&b)e.push(l),s.push(b)}}else e.push(u===">"?"/":u);return[e,s]},[[],[]]);if(n.endsWith("/")&&n.length>1)i.push("/");return{parsed:i,args:o}};class et{storage=new f;cache(t,n){if(this.storage.lacks(t))this.storage.set(t,n());return this.storage.get(t)}}var An=["int","float","file","uuid","string"],qn=new et;class Q{_storage=new f;set(t){let{parsed:n,path:r}=t,i=E(n);if(!this._storage.get(i))this._storage.set(i,t);else throw`path: ${r} already used.`}get(t){let{parsed:n}=qn.cache(t,()=>ot(t)),r={},i=this._storage.get(E(n));if(!i&&t!=="/")for(let o of this._storage.keys()){let e=[],s=Qt(o);if(n.length===s.length){let u=s.map((b,j)=>{let D=Ot(n[j],n.length-1===j);if(b===D[0])return D[0];if(An.includes(D[1]))return e.push(D[0]),D[1];return b}),m=E(u);if(this._storage.has(m)){i=this._storage.get(m),i?.args.forEach((b,j)=>{r[b]=e[j]});break}}}return[i,r]}}class P{path="";parsed=[];args=[];constructor(t){nt(this,{path:t,...ot(t)})}}class _t{static rand(t=6,n){if(n)return Math.floor(Math.random()*(n-t+1)+t);return Math.floor(Math.random()*t)+1-1}static fill(t,n=null){return Array(t).fill(n)}static new({dom:t,id:n,inner:r}){let i=document.createElement(t);if(n)i.id=n;if(r)i.innerHTML=r;return i}static randFrom(t){if(Array.isArray(t)){let n=t.length,r=this.rand(0,n-1);return t[r]}else if(typeof t=="object"){let n=J(t),r=n.length,i=this.rand(0,r-1);return n[i]}}static makeID=p;static reClass=Vt;static get O(){return{vals:y,keys:J,items:h,has:Yt,ass:T,len:(t={})=>J(t).length}}}var Tt={},Z={};class kt{stream;url;constructor(t,n){if(this.url=t,t in Tt)this.stream=Tt[t];else this.stream=new EventSource(t,{withCredentials:n}),Tt[t]=this.stream,Z[this.url]={}}on(t){let n=this.stream;return h(t).forEach(([r,i])=>{if(r in Z[this.url])Z[this.url][r].forEach((o)=>{this.stream.removeEventListener(r,o)}),Z[this.url][r]=[];if(n.addEventListener(r,i),!(r in Z[this.url]))Z[this.url][r]=[];Z[this.url][r].push(i)}),this}}function vt(t,n=!0){return new kt(t,n)}class tn{value;constructor(t){this.value=t}get str(){return String(this.value).toString()=="null"?null:String(this.value).toString()}get int(){if(R(this.value))return parseInt(this.value);else return null}get float(){if(R(this.value))return parseFloat(this.value);else return null}get bool(){if(this.value==="true")return!0;else if(this.value=="false")return!1;else return null}get json(){if(this.value)return JSON.parse(this.value);return null}}class z{key;func;storage;constructor(t,n="local"){if(typeof t=="object"){let[r,i]=h(t)[0];this.key=r,this.func=i}else this.key=t,this.func=null;this.storage=n=="local"?localStorage:sessionStorage}get as(){return new tn(this.storage.getItem(this.key))}get value(){return this.storage.getItem(this.key)}get save(){if(this.func)this.set=this.func();return}set set(t){if(typeof t=="object")this.storage.setItem(this.key,JSON.stringify(t));else this.storage.setItem(this.key,String(t))}get remove(){this.storage.removeItem(this.key);return}}var K={get:(t)=>new z(t)};var nn={get:(t)=>new z(t,"session")};class st extends P{id;cls;constructor(t,n,r){super(t);this.id=n;this.cls=r}}class rn extends P{id;cls;constructor(t,n,r){super(t);this.id=n;this.cls=r}}class ut extends dt{ImportMeta;config;storage=new Q;errorStorage=new Q;wssStorage=new Q;route;error;wss;constructor(t,n){super();this.ImportMeta=t;this.config=n;this.route=(r)=>{return(i)=>{return this.storage.set(new st(r,p(5),i)),i}},this.wss=(r)=>{return(i)=>{return this.wssStorage.set(new rn(r,p(5),i)),i}},this.error=(...r)=>{return(i)=>{if(r.length)r.forEach((o)=>{this.errorStorage.set(new st(o.toString(),p(5),i))});else this.errorStorage.set(new st("404",p(5),i));return i}}}async getPath(t){return this.storage.get(t)}async loadError(t){return this.errorStorage.get(t.toString())}async loadWSS(t){return this.wssStorage.get(t)}}var N=new f,V=(t)=>{if(c)return;let n=N.get(t);if(n?.isConnected)return n;N.delete(t);let r=document.getElementById(t);if(!r)return;return N.set(t,r),r};function on(){let t=[];return N.forEach((n,r)=>{if(!n.isConnected)t.push(r),N.delete(r)}),t}function Y(t,n,{id:r="state",init:i}={}){let o=[],e=()=>n.map((u)=>u.value),s=()=>{t(...e())};if(n.forEach((u)=>{o.push(u.hook(s)(r))}),i)s();return()=>{o.forEach((u)=>u())}}var en=(t)=>{t.forEach((n)=>n())};var Ln=(t,n)=>{for(let[r,i]of t){let o=V(r);if(!o){t.delete(r);continue}i.forEach((e)=>{e.call(o,n)})}};class I extends EventTarget{options;hooks=new f;states=new f;_value;listening=!1;end;constructor(t,n){super();this.options=n;this._value=t}get value(){return this._value}set value(t){if(C(t)||Xt(t))return;if(k(this._value)||a(this._value)){let n=lt(this._value,t);if(!Ct(n))return}else if(this._value instanceof Set){if(!Bt(this._value,t))return}else if(this._value===t)return;this._value=t,this.dispatchEvent(new CustomEvent("updated",{detail:this._value}))}get listen(){let t=(n)=>{if(en(this.hooks),Ln(this.states,n.detail),!this.states.size&&!this.hooks.size)this.end?.()};if(!this.listening)this.addEventListener("updated",t,this.options),this.listening=!0;return()=>{this.listening&&this.removeEventListener("updated",t,this.options),this.end=void 0,this.listening=!1}}call(t,n){return(r)=>{if(rt(r,this.states).set(n,t),!c&&!this.listening)this.end=this.listen;return()=>{if(this.states.has(r))this.states.get(r)?.delete(n)}}}hook(t){return(n)=>{if(this.hooks.set(n,t),!c&&!this.listening)this.end=this.listen;return()=>{if(this.hooks.has(n))this.hooks.delete(n)}}}}function A(t){return new I(t)}var bt=(t)=>{if(a(t))return t.join(" ");else if(w(t)){if(at(t))return E(t)}else if(x(t))return bt(t());else if(t!==void 0&&t!==null)return v(t)?t?"":"false":String(t);return""};function Mn(t,n){switch(n??t){case"style":return function(r){this.style.setProperty(t,r)};default:return function(r){this.setAttribute(t,r)}}}class yt{attr;constructor(t={}){this.attr=t}get(t,n=this.attr,r){let i=(o,e)=>{if(a(e))t.attr_push(o,bt(e));else if(e instanceof I){let s=r?`${r}_${o}`:o;t.states.push(e.call(Mn(o,r),s)),i(o,e.value)}else if(w(e)){if(at(e)&&!r)this.get(t,e,o)}else t.attr_push(o,bt(e),r)};h(n).forEach(([o,e])=>{if(["on"].includes(o))w(n.on)&&t.events.obj(n.on);else i(o,e)})}}class W{xid;IDM;map=new f;states=[];events=new f;OZ;constructor(t,n=new d,r){this.xid=t;this.IDM=n;this.OZ=r??new ft}attr_push(t,n,r){let i=r??t;if(!this.map.has(i))this.map.set(i,[]);let o=r?`${S(t)}:${n};`:n;this.map.get(i).push(o)}get attr(){let t=[""];return this.map.forEach((n,r)=>{let i=n.join("");t.push(i?`${r}="${i}"`:r)}),t.join(" ")}set id(t){if(!this.map.has("id"))this.map.set("id",[t])}get id(){return this.map.get("id")?.join("")}}var Rn=(t,n,r)=>{return t.addEventListener(n,r),()=>{t.removeEventListener(n,r)}},O={};class ft{events=new f;states=new f;winStates=new f;windowEvents=new f;resetST=new f;resetEV=new f;constructor(){}get keys(){return[...new Set([...this.states.keys(),...this.events.keys()])]}set(t){let{id:n,events:r,states:i}=t;if(n){if(r.size)this.events.set(n,r);if(i.length)this.states.set(n,i)}return this}push(t){return t.events.forEach((n,r)=>{n.forEach((i,o)=>{rt(r,this.events).set(o,i)})}),t.states.forEach((n,r)=>{G(r,this.states).push(...n)}),this}get stage(){return this.events.forEach((t,n)=>{this.events.delete(n);let r=V(n);if(!r){this.events.delete(n);return}t.forEach((i,o)=>{switch(o){case"ready":i.apply(r,[r]);break;case"resize":case"beforeunload":case"popstate":case"winscroll":case"winload":case"winfocus":case"winblur":let e=o.replace(/^win/,"");this.windowEvents.init(e,new f).set(n,i);break;case"watch":let[s,u,m]=i.apply(r,[r]),l=a(u)?u:[u],b=()=>l.map((D)=>D.value),j=()=>s(...b());if(m)j();l.forEach((D)=>G(n,this.resetST).push(D.call(j,n+"_watch")(n)));break;default:G(n,this.resetEV).push(Rn(r,o,i))}})}),this.processWindowEvents,this.states.forEach((t,n)=>{this.states.delete(n),t.forEach((r)=>{G(n,this.resetST).push(r(n))})}),this}get processWindowEvents(){let t=(n,r)=>{let i=(o)=>{r.forEach((e,s)=>{let u=V(s);if(u)e.call(u,o);else this.windowEvents.get(n)?.delete(s)})};return window.addEventListener(n,i),()=>{window.removeEventListener(n,i)}};return this.windowEvents.forEach((n,r)=>{if(n.size){if(!O[r])O[r]=t(r,n)}else if(O[r])O[r](),delete O[r]}),this}reset(t){return t.forEach((n)=>{this.windowEvents.forEach((r,i)=>{if(r.has(n))r.delete(n)}),this.resetEV.get(n)?.forEach((r)=>{r()}),this.resetST.get(n)?.forEach((r)=>{r()}),this.resetST.delete(n),this.resetEV.delete(n)}),this}RPS(t){if(t){let n=on();this.reset(n);let r=t.keys;if(r.length)this.reset(r).push(t).stage}return this}}var q=new ft;var Sn=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],Fn=(t)=>Sn.includes(t);function Zn(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var mt=(t,n)=>{if(a(t))return t.map((r)=>mt(r,n)).join("");else if(t instanceof L){let r=t.__(n.IDM),{ctx:i,oz:o}=r;return n.OZ.push(o),i}else if(w(t))return E(t);else if(x(t))return mt(t(),n);else if(t!==void 0&&t!==null)return Zn(t);return""},sn=(t,n)=>{let r=new d(t),i=new W(r.id,r);return{ctx:mt(n,i),catt:i}};function In(t){let n=this.id;if(n){let{ctx:r,catt:i}=sn(n,t);if(this.innerHTML!==r)this.innerHTML=r,q.RPS(i.OZ)}}var xt=(t,n,r,i=[])=>{if(a(t))t.forEach((o)=>{xt(o,t.length,r,i)});else if(t instanceof I)if(n>1)xt(M("div",{},t),n,r,i);else{let o=t.value,e=o instanceof L?"dom":"ctx",{ctx:s,catt:u}=sn(r.xid+"-0",o);r.xid=u.xid,i.push(s),r.OZ.push(u.OZ),r.states.push(t.call(In,e))}else i.push(mt(t,r))};class Et{tag;ctx;closing;constructor(t,n){this.tag=t;this.ctx=n;let r=Fn(t);this.closing=r?"":`</${t}>`}process(t,n=this.ctx,r=[]){return n.forEach((i)=>{xt(i,n.length,t,r)}),r.join("")}get(t){let n=this.process(t);if(t.events.size||t.states.length)t.id=t.xid;return`<${this.tag}${t.attr}>${n}${this.closing}`}}class L{tag;constructor(t,n={},...r){this.tag=t;nt(this,{attr:new yt(n),ctx:new Et(t,r)})}__(t=new d){let n=t.mid,r=new W(n,t);return this.attr.get(r),{ctx:this.ctx.get(r),oz:r.OZ.set(r),id:r.id}}}function M(t,n={},...r){if(x(t))return t(n??{},...r);return new L(t,n??{},r)}var Xn=(t,...n)=>n;class $t{e;opt;constructor(t){this.e=t;this.opt={duration:500,easing:"ease-in-out",fill:"forwards"}}animate(t,n={}){return this.e.animate(t,n)}get slide(){let t=({x:n=0,y:r=0},i={})=>{T(this.opt,i);let o=[[n,r],[0,0]].map(([e,s])=>({transform:`translateX(${e}rem) translateY(${s}rem)`}));return this.e.animate(o,this.opt),this};return{left:(n={})=>{return t({x:-2},n)},right:(n={})=>{return t({x:2},n)},up:(n={})=>{return t({y:2},n)},down:(n={})=>{return t({y:-2},n)}}}fade(t={}){T(this.opt,t);let n=[0,1].map((r)=>({opacity:r}));return this.e.animate(n,this.opt),this}shake(t="Y",n={}){T(this.opt,n);let r=[0,5,-5,5,0].map((i)=>({transform:`translate${t}(${i}px)`}));return this.e.animate(r,this.opt),this}color(t=[],n={}){T(this.opt,n);let r=Array.isArray(t)?t.map((i)=>({color:i})):{color:t};return this.e.animate(r,this.opt),this}bg(t=[],n={}){T(this.opt,n);let r=Array.isArray(t)?t.map((i)=>({backgroundColor:i})):{backgroundColor:t};return this.e.animate(r,this.opt),this}bounce(t=1,n={}){T(this.opt,n);let r=[0.5,t,1].map((i)=>({transform:`scale(${i})`}));return this.e.animate(r),this}}class jt{e;query;constructor(t,n){this.e=t;this.query=n}get a(){return new $t(this)}get all(){if(this.query){let t=document.querySelectorAll(this.query);if(t.length)return Array.from(t).map((n)=>n)}return[]}get attr(){let t=this.e;return{has:(n)=>{return t.hasAttribute(n)},get:(n)=>{return t.getAttribute(n)},del:(n)=>{return t.removeAttribute(n),this},set:(n)=>{for(let r in n){let i=n[r];if(n[r]!==void 0)t.setAttribute(r,i?i:"")}return this}}}get children(){return Array.from(this.e.children).map((t)=>g(t))}get click(){return this.e.click(),this}get delete(){return this.e.remove(),this}get disabled(){return this.e.disabled??!1}get focus(){return this.e.focus(),this}get href(){return this.e?.href??""}get id(){return this.e.id}get inner(){return this.e.innerHTML}get offsetParent(){let t=this.e.offsetParent;if(t)return new X(t);return}get parent(){let t=this.e.parentElement;if(t)return new X(t);return}get path(){return this.e?.pathname??""}get rect(){return this.e.getBoundingClientRect()}get remove_element(){return this.e.remove(),this}get style(){let t=this.e.style,n=this;return{set:(r,i=0)=>{let o=t,e=()=>{h(r).forEach(([s,u])=>{if(s in o){if(o[s]!==u)o[s]=u}else if(u!==null)t.setProperty(s,String(u))})};if(x(i))n.on("transitionend",i);if(It(i))setTimeout(e,i);else e();return n},get:(r)=>{return t.getPropertyValue(r.toString())},del:(...r)=>{r.forEach((i)=>{t.removeProperty(i.toString())})}}}get submit(){let t=this.e;if("submit"in t)return t.submit();return!1}get tag(){return this.e.tagName.toLowerCase()}get value(){return this.e.value??""}get unload(){return()=>{this.e.remove()}}set append(t){let{ctx:n,oz:r}=wt(t,Ht(this.id));this.e.insertAdjacentHTML("beforeend",n),q.RPS(r)}set appendfirst(t){let{ctx:n,oz:r}=wt(t,Ht(this.id));this.e.insertAdjacentHTML("afterbegin",n),q.RPS(r)}set inner(t){let{ctx:n,oz:r}=wt(t,Ht(this.id));this.e.innerHTML=n,q.RPS(r)}set disabled(t){let n=this.e;if("disabled"in n)n.disabled=t}set id(t){this.e.id=t}set value(t){let n=this.e;n.value=t}}var wt=(t,n)=>{if(t instanceof L)return t.__(new d(n));return{ctx:t,oz:void 0}},Ht=(t)=>t?`${t}-0`:t;class X extends jt{constructor(t,n){super(t,n)}add(...t){return this.e.classList.add(...t.map((n)=>n.replace(/[^\w-]/,""))),this}remove(...t){return this.e.classList.remove(...t.map((n)=>n.replace(/[^\w-]/,""))),this}toggle(t,n){let r=typeof t!="string"?t.apply(this):t,i=this.e.classList;return r.split(" ").forEach((o)=>{i.toggle(o,n)}),this}has(t){return this.e.contains(t)}insert(t){return{HTML:(...n)=>{return n.forEach((r)=>{this.e.insertAdjacentHTML(t,r)}),this},element:(...n)=>{return n.forEach((r)=>{this.e.insertAdjacentElement(t,r)}),this},text:function(...n){return n.forEach((r)=>{this.e.insertAdjacentText(t,r)}),this}}}is(t){let n=this.e.classList.value.split(" "),r=this.e.tagName.toLocaleLowerCase(),i=!0,o=!0;if(t.dom)o=t.dom==r?!0:!1;if(t.class)if(Array.isArray(t.class))t.class.forEach((e)=>{i=i?n.includes(e):!1});else i=i?n.includes(t.class):!1;return i&&o}on(t,n,r=!1){let i=!1;if(t.indexOf("touch")>-1)i=!0;return this.e.addEventListener(t,n,{capture:r,passive:i}),this}remove_on(t,n,r=!1){return this.e.removeEventListener(t,n,r),this}timed(t,n=250){return setTimeout(()=>t(this),n),this}animate(t,n,r){let i={duration:300,easing:"ease",fill:"forwards"};if(x(n))r=n;else T(i,n);let o=this.e.animate(t,i);if(r)o.finished.then(r);return this}}function g(t){if(tt(t)){let n=document.querySelector(t);if(n)return new X(n,t);return}else return new X(t)}class ht extends ct{path;args;id;status;lang;import;_data={};constructor(t,n={},r,i=200){super();this.path=t;this.args=n;this.id=r;this.status=i}async loader(){if(this.import)try{let t=await this.import;if(t.default)this.import=await t.default({...this.args,...this.data});else this.import=void 0}catch(t){H.p=t,this.import=void 0}if(this.body){let t=await this.body();return a(t)?t:[t]}if(this.import){let t=this.import;return a(t)?t:[t]}return[]}getHeadAttr(t={},...n){let r=new U;if($(t))r.head=t;r.id=this.id;let i=r.head;return n.forEach((o)=>{i.map(o)}),Jn(r,this),i}set data(t){T(this._data,t)}get data(){return this._data}}class Dt extends ht{head(){this.title=`error ${this.status}`}body(){return M("div",{},this.path+" not found...")}}function Jn(t,n){let{link:r,script:i,meta:o,title:e,base:s,description:u,css:m}=n;if(t.head={title:e,base:s,meta:o,link:r,script:i},u)t.head={meta:[{name:"description",content:u}]};if(m){let b=(a(m)?m:[m]).map((j)=>({rel:`${c?"preload ":""}stylesheet`,href:j,as:"style"}));if(t.head.lacks("link"));t.head={link:[...b]}}}function un(t){let n=[];if(t?.length){let{href:r,target:i}=t[0],o=g("base");if(o)o.attr.set({href:r,target:i});else{let e=g(document.createElement("base"));e.attr.set({href:r,target:i}),document.head.append(e.e)}}else{let r=g("base")?.unload;r&&n.push(r)}return n}var fn=new f;async function mn(t,n=!1){let r=_.value,i={};if(g("link")?.all.forEach((o)=>{let e=g(o),s=e.attr.get("href");if(s){let u=e.attr.get("rt");if(n){let m=fn.get(r);if(m){if(!m.has(s))i[s]=e.unload}else i[s]=e.unload}else if(u)i[s]=e.unload}}),t&&$(t))for(let o of y(t)){let e=o.href;if(!(e in i))try{if(!n){o.rt=!0;let s=fn.init(r,new Set);if(!s.has(e))s.add(e)}await pt(o)}catch(s){H.p=s}else delete i[e]}return y(i)}var Un=["charset","name","property","http-equiv"];function hn(t){let n={};if(g("meta")?.all.forEach((r)=>{let i=r.attributes;for(let o of Un)if(o in i){let e=i[o].value;n[`${o}_${o==="charset"?"":e}`]=r}}),t)h(t).forEach(([r,i])=>{if(r in n)g(n[r]).attr.set(i),delete n[r];else{let o=g(document.createElement("meta"));o.attr.set(i),document.head.append(o.e)}});return y(n).map((r)=>g(r).unload)}var an=new f;async function gn(t,n=!1){let r=_.value,i={};if(g("script[yid]")?.all.forEach((o)=>{let e=g(o),s=e.attr.get("yid");if(s){let u=e.attr.get("rt");if(n){let m=an.get(r);if(m){if(!m.has(s))i[s]=e.unload}else i[s]=e.unload}else if(u)i[s]=e.unload}}),t){for(let o of t)if("yid"in o)if(o.yid in i)delete i[o.yid];else try{if(!n){o.rt=!0;let e=o.yid,s=an.init(r,new Set);if(!s.has(e))s.add(e)}await Nt(o)}catch(e){H.p=e}}return y(i)}async function ln(t,n,r=!1){let i=[];if(c)return[];let o=t.get("title")??"";if(r){let{pushState:s}=this.config,u=this.path.value;if(s)At(u,o);document.documentElement.lang=n,document.title=o}let e=this.path.value;if(r)i.push(...un(t.get("base"))),i.push(...hn(t.get("meta")));return i.push(...await mn(t.get("link"),r)),i.push(...await gn(t.get("script"),r)),i}function At(t,n){let r=window.location.pathname;if(t&&r!==t)history.pushState({},n??"",t)}class qt{lang;head="";constructor(t,n){if(this.lang=t,n)this.head=Kt(n)}body(t,n,r){return[`<!DOCTYPE html><html lang="${this.lang}">`,`<head>${this.head}</head>`,`<body id="${n??p(5)}"${r?" "+r:""}>${t}</body>`,"</html>"].join("")}}class Lt{path;args;isConnected=A(!1);data={};constructor(t,n={}){this.path=t;this.args=n}open(t){}message(t){}close(t){}error(t){}get connect(){if(this.ws&&this.ws.readyState<=1)return this;return this.ws=new WebSocket(this.path),this.ws.onopen=async(t)=>{this.isConnected.value=!0,await this.open.call(this,t)},this.ws.onmessage=async(t)=>{await this.message.call(this,t)},this.ws.onclose=async(t)=>{this.isConnected.value=!1,await this.close.call(this,t)},this.ws.onerror=async(t)=>{this.isConnected.value=this.ws.readyState<=1,await this.error.call(this,t)},this}get reconnect(){if(this.state>=2)this.connect;return this}get disconnect(){if(this.state<=1)this.ws.close();return this}get state(){return this.ws?.readyState??3}set send(t){this.ws.send(t)}}var B=new f;class Mt{yra;constructor(t){this.yra=t}async load(t){if(!B.has(t)){let[r,i]=await this.yra.loadWSS(t);if(!r)return;let{cls:o,path:e,id:s}=r,u=new o(e,i).connect;return B.set(t,u),u}let n=B.get(t);return n.reconnect,n}unload(t){if(B.has(t)){let n=B.get(t);if(!n)return;n.disconnect,B.delete(t)}}}function Qn(t,n,r){let i={...t.on??{},click(o){o.preventDefault(),r.value=g(this).path}};return delete t.on,M("a",{...t,on:{...i}},...n)}function Yn(t,n,r){let{classes:i}=t.config,{load:o,on:e,...s}=n,u={...n.on??{},...!r&&o&&{ready(m){t.load(o)}},...r&&{popstate(m){let l=m.target;t.path.value=l.location.pathname}}};return M("div",{...s,...i&&{class:i},on:u},t.root)}class Rt extends ut{isYRA;unload=!1;hook;root=A([]);socket;id=p(4);path=A("");A;Main;load;constructor(t,n={},r=!1){super(t,n);this.isYRA=r;this.socket=new Mt(this),this.A=(i,...o)=>{return Qn(i,o,this.path)},this.Main=(i)=>{return Yn(this,i,r)},this.load=async(i,o={})=>{if(this.hook)this.hook();if(i)this.path.value=i,await this.render(i,404,o),this.hooker();return this}}hooker(){let t={},n=this.path.value;if(this.hook)this.hook();this.hook=Y(async(r)=>{if(t[n]=window.scrollY,(await this.render(r,404)).done)window.scrollTo({top:t[r]??0,behavior:"instant"}),n=r},[this.path],{id:"router"})}async class(t,n,r=!1){let[i,o]=await this.getPath(t);if(i&&!r){let{cls:e,path:s,id:u}=i;return new e(s,o,u)}else return Wn.call(this,t,n)}async fetch(t){if(t)try{if(t.fetch){let n=await t.fetch();if(k(n)&&$(n))t.data=n}}catch(n){H.p=n}}async processHead(t,n={}){return t?await this.processClassHead(t,n):await this.processDefaultHead(n)}async processClassHead(t,n){if(t.head)await t.head();return t.getHeadAttr(n,this.htmlHead)}async processDefaultHead(t){let n=new U;if($(t))n.head=t;return n.head.map(this.htmlHead),n.head}async render(t,n=404,r={},i={},o=!0,e=!1){if(c)this.path.value=t;let s=await this.class(t,n??Cn(),e);s.data=r,await this.fetch(s);let u=await this.processHead(s,i);if(!s)return{lang:this.lang,heads:u,done:!1};let m=await s.loader();if(o){let l=await ln.call(this,u,s?.lang||this.lang,this.unload);if(o)l.forEach((b)=>b())}if(m.length)this.root.value=m;else await this.render(t,n,r,i,o,!0);return{heads:u,lang:s.lang??this.lang,done:!0}}}async function Wn(t,n){let[r,i]=await this.loadError(n??0);if(r){let{cls:o,id:e}=r;return new o(t,i,e,n)}else{let o=new Dt(t,i,p(5));return o.title=`error ${n}`,o}}var _=A("");class cn extends Rt{unload=!0;constructor(t,{classes:n,pushState:r=!0}={}){super(t,{classes:n,pushState:r},!0);this.path=_,this.head({meta:[{charset:"utf-8"},{name:"viewport",content:"width=device-width, initial-scale=1.0"}]}),this.load=async(i=location.pathname,o={})=>{if(this.hook)this.hook();if(i)this.path.value=i;if(gt)this.render(i,404,o).then(()=>{if(i&&this.config.pushState)At(i,document.title);Bn.call(this,this.Main({})),this.hooker()});return this}}async html({path:t,data:n={},status:r=200,attr:i=""}){let o={script:[{type:"module",src:this.ImportMeta.file}]};Gn(o,r);let{lang:e,heads:s}=await this.render(t,r,n,o,!1),{ctx:u}=this.Main({}).__(new d(this.id));return new qt(e,s).body(u,this.id,i)}}function Bn(t){let n=document.body.id,{oz:r,id:i}=t.__(new d(n));if(this.id=i||this.id,!r)return;q.push(r),requestAnimationFrame(()=>{q.stage})}function Cn(){if(gt)return parseInt(g('meta[name="error-code"]')?.attr.get("content")??"404");return 404}var Gn=(t,n)=>{switch(n){case 404:t.meta=[{name:"error-code",content:n.toString()}];return;default:return}};class St{state;body;click;constructor({toggle:t=[],initialState:n=!1}={}){this.state=A(n);let r=this.state;this.click=function(){r.value=!r.value},this.loader(t)}loader(t){if(typeof window==="undefined")return;let n=K.get("LOCAL_SCHEME"),r=this.isDark,i=n.as.bool,o=K.get({IS_DARK:()=>this.state.value});if(i!=null&&i!==r)this.state.value=!i,o.save,n.set=r;if(o.as.bool!==null)this.state.value=o.as.bool;let e=this.toggle,s=document.documentElement.classList;if(e(s,this.state.value,t),Y(async(u)=>{e(s,u,t),o.save},[this.state],{id:"colorScheme"}),this.isMatchMediaSupported)window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(u)=>{let l=(u.matches?"dark":"light")==="dark";this.state.value=l,n.set=l})}get isMatchMediaSupported(){return window.matchMedia&&typeof window.matchMedia==="function"}get isDark(){return window.matchMedia("(prefers-color-scheme: dark)").matches}toggle(t,n,r){if(n)t.add(...r);else t.remove(...r)}}St=Ft([Gt,Zt("design:paramtypes",[Object])],St);var Ve=(t,n)=>{return`${t.replace(/\/+$/,"")}/${n.replace(/^\.\/+/,"")}`},Oe=(t)=>{return(n)=>{t(n)}},_e=(t)=>{return(n)=>{t(n)}};export{Lt as websocket,Y as stateHook,nn as session,Ve as resolvePath,ut as minClient,K as local,Xn as frag,vt as eventStream,M as dom,ht as doc,pt as cssLoader,Dn as addCSS,_t as __,cn as Yvee,I as Stateful,A as State,Oe as Routes,Rt as Router,it as Meta,_e as Errors,L as Dom,St as ColorScheme,H as $$,g as $};
