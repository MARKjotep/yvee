var jr=Object.defineProperty;var wr=(t,r)=>{for(var n in r)jr(t,n,{get:r[n],enumerable:!0,configurable:!0,set:(i)=>r[n]=()=>i})};var Ct=function(t,r,n,i){var e=arguments.length,o=e<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,n):i,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(t,r,n,i);else for(var u=t.length-1;u>=0;u--)if(s=t[u])o=(e<3?s(o):e>3?s(r,n,o):s(r,n))||o;return e>3&&o&&Object.defineProperty(r,n,o),o};var Pt=(t,r)=>{if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,r)};var xt={};wr(xt,{isWindow:()=>L,isUndefined:()=>bt,isStr:()=>V,isPromise:()=>Rr,isPlainObject:()=>G,isObj:()=>$,isNumber:()=>q,isNum:()=>Tt,isNull:()=>J,isNotWindow:()=>b,isInt:()=>yt,isFN:()=>T,isDict:()=>it,isClassOrId:()=>Mr,isBool:()=>N,isAsync:()=>Ar,isArraybuff:()=>Hr,isArr:()=>a});var T=(t)=>typeof t==="function",Ar=(t)=>t.constructor.name==="AsyncFunction",Rr=(t)=>!!t&&typeof t.then==="function",q=(t)=>{return!isNaN(parseFloat(t))&&isFinite(t)},it=(t)=>{return typeof t==="object"&&t!==null&&!Array.isArray(t)},G=(t)=>{return typeof t==="object"&&t!==null&&Object.getPrototypeOf(t)===Object.prototype},Hr=(t)=>{return t instanceof Uint8Array||t instanceof ArrayBuffer||typeof t==="string"},Mr=(t)=>{return t.startsWith(".")||t.startsWith("#")},N=(t)=>typeof t==="boolean",V=(t)=>typeof t==="string",a=(t)=>Array.isArray(t),$=(t)=>typeof t==="object",Tt=(t)=>typeof t==="number",J=(t)=>t===null,bt=(t)=>typeof t==="undefined",yt=(t)=>{return Number.isInteger(Number(t))},L=typeof window!=="undefined",b=typeof window==="undefined";function et(t,r){l(r).forEach(([n,i])=>{Wt(t,n,{value:i,writable:!1,configurable:!1,enumerable:!0})})}class j{static set p(t){if(Array.isArray(t))console.log(...t);else console.log(t)}}class y{_c=0;_id="";constructor(t){if(this._c=0,this._id=t??p(5),t?.includes("-")){let[r,n]=[t.split("-").slice(0,-1).join("-"),t.split("-").slice(-1)[0]];this._id=r,this._c=q(n)?parseInt(n):0}}get id(){return this._id+"-"+this._c}get mid(){return this._id+"-"+ ++this._c}}var Tn=new RegExp(/(\d+)(\d*)/,"m"),Dr=(t)=>Array.from({length:t},(r,n)=>n),Ut="ABCDEFGHIJKLMNOPQRSTUVWXYZ",zt="abcdefghijklmnopqrstuvwxyz",qr=Dr(10).join("");var w=(t)=>JSON.stringify(t),Kt=(t)=>{return JSON.parse(t)},F=(t)=>{if(t.startsWith("webkit"))t="-"+t;return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},p=(t)=>{let r=Ut+zt;return Array.from({length:t},(n,i)=>r+(i?qr:"")).reduce((n,i)=>{return n+=i.charAt(Math.floor(Math.random()*i.length))},"")},Zr=(t=6,r)=>{if(!r)return Math.floor(Math.random()*t);return Math.round(Math.random()*(r-t)+t)},Bt=[...Ut,...zt],Gt=()=>{let t=Zr(0,Bt.length);return Bt[t]};var Nt=(t,r)=>{let n=r==="/"?"":r;return r.startsWith("/")?t+n:r};class m extends Map{obj(t){t&&l(t).forEach(([r,n])=>this.set(r,n))}map(t){t.forEach((r,n)=>{if(r instanceof m)this.set(n,r);else if(a(r)){if(this.lacks(n))this.set(n,[]);this.get(n).push(...r)}else if($(r))this.ass(n,r);else this.set(n,r)})}ass(t,r){if(!this.has(t))this.set(t,{});d(this.get(t),r)}lacks(t){return!this.has(t)}init(t,r){return this.has(t)?this.get(t):this.set(t,r).get(t)}}var{values:E,keys:I,entries:l}=Object;var{hasOwn:Vt,freeze:Ot,defineProperty:Wt,assign:d}=Object,x=(t)=>{return Object.keys(t).length},ot=(t,r)=>{if(!r.has(t))r.set(t,new m);return r.get(t)},O=(t,r)=>{if(!r.has(t))r.set(t,[]);return r.get(t)},Et=(t,r)=>{let n={added:{},removed:{},modified:{}},i=I(t),e=I(r);for(let o of e){let s=t[o],u=r[o];if(!(o in t))n.added[o]=u;else if(a(s)&&a(u)){if(w(s)!==w(u))n.modified[o]={old:s,new:u}}else if($(s)&&$(u)&&!J(s)&&!J(u)){let f=Et(s,u);if(x(f.added)||x(f.removed)||x(f.modified))n.modified[o]={old:s,new:u}}else if(s!==u)n.modified[o]={old:s,new:u}}for(let o of i)if(!(o in r))n.removed[o]=t[o];return n};function _t(t,r){if(t.size!==r.size)return!1;for(let n of t)if(!r.has(n))return!1;return!0}var kt=(t)=>{return E(t).some((r)=>{return x(r)})};function vt(t){let r;return class extends t{constructor(...n){if(r)return r;super(...n);Ot(this),r=this}}}var X=(t,r)=>{return{name:t,content:r}},Qr=(t,r)=>{return{property:t,content:r}},Fr=(t,r)=>{return{"http-equiv":t,content:r}};class st{metas=[];constructor(t){t&&this.metas.push(X("description",t))}author(t){return this.meta=X("author",t),this}charset(t){return this.meta={charset:t},this}keywords(...t){return this.meta=X("keywords",t.join(", ")),this}viewport(t){let r=l(t).map(([n,i])=>[F(n),String(i)].join("="));return this.meta=X("viewport",r.join(", ")),this}httpEquiv(t){return l(t).forEach(([r,n])=>{this.meta=Fr(F(r),String(n))}),this}robots(...t){return this.meta=X("robots",t.join(", ")),this}themeColor(t){return this.meta=X("theme-color",t),this}openGraph(t){return l(t).forEach(([r,n])=>{this.meta=Qr("og:"+r,String(n))}),this}twitter(t){return l(t).forEach(([r,n])=>{this.meta=X("twitter:"+r,String(n))}),this}and(t){return this}set meta(t){this.metas.push(t)}}class $t{title;description;base;meta;link;script;css}var Xr=["charset","name","property","http-equiv"],tr=(t,r)=>{r.forEach((n)=>{for(let i of Xr)if(i in n){let e=n[i];t[`${i}_${i==="charset"?"":e}`]=n}})},Yr=(t,r)=>{r.forEach((n)=>{if("href"in n){let i=n.href;t[`${i}`]=n}})};class S{_head;idm;constructor(t){this._head=new m(t)}set head(t){l(t).forEach(([r,n])=>{if(r==="title"||r==="base"){if(n!==void 0)this._head.set(r,n);return}if(n instanceof st)return tr(this._head.init("meta",{}),n.metas);if(!a(n))return;switch(r){case"meta":return tr(this._head.init("meta",{}),n);case"link":return Yr(this._head.init("link",{}),n);case"script":if(n.length){this._head.init(r,[]);let i=n.map((e)=>{if(!e.yid&&this.idm)e.yid="sc"+this.idm.mid;return e});this._head.get(r).push(...i)}return}})}get head(){return this._head}set id(t){this.idm=new y(t)}}var rr=(t)=>{return l(t).reduce((r,[n,i])=>{return r.push(N(i)&&i?n:`${n}="${i}"`),r},[""]).join(" ")},nr=(t)=>{if(!t)return"";return[...t].reduce((r,[n,i])=>{if(n==="meta"||n==="link")i=E(i);if(V(i))return r.push(`<${n}>${i}</${n}>`),r;if(!a(i))return r;let e=i.map((o)=>{if(n==="script"){let s={...o},u="";if("importmap"in s)s.type="importmap",u=JSON.stringify(s.importmap),delete s.importmap;else if("body"in s)u=s.body,delete s.body;return`<${n}${rr(s)}>${u}</${n}>`}return`<${n}${rr(o)}>`});return r.push(...e),r},[]).join("")};class jt{lang="en";htmlHead=new m;head;constructor(){this.head=(t={})=>{let r=new S(this.htmlHead);r.head=t,this.htmlHead=r.head}}}var wt=(t)=>{if(b)return;return new Promise((r,n)=>{let i=document.createElement("link");if(t.rel!=="stylesheet")t.rel="stylesheet",t.as="style";l(t).forEach(([e,o])=>{i.setAttribute(e,o)}),i.onload=()=>r(i),i.onerror=()=>n(new Error("Failed to load CSS")),document.head.appendChild(i)})},ir=(t)=>{if(b)return;return new Promise((r,n)=>{let i=document.createElement("script"),e="";if("importmap"in t)t.type="importmap",e=JSON.stringify(t.importmap),delete t.importmap;else if("body"in t)e=t.body,delete t.body;if(e)i.textContent=e;l(t).forEach(([o,s])=>{i.setAttribute(o,s)}),i.onload=()=>r(i),i.onerror=()=>n(new Error("Failed to load Script")),document.head.appendChild(i),requestAnimationFrame(()=>r("Script executed"))})},Jr=()=>{let r=document.querySelector("#d-css")?.sheet;if(r)return r;let n=document.createElement("style");return n.id="d-css",document.head.appendChild(n),n.sheet},Lr=(t,r)=>{for(let n=0;n<t.cssRules.length;n++)if(t.cssRules[n].selectorText===r)return!0;return!1},Ir=(t)=>Object.entries(t).map(([r,n])=>`${F(r)}: ${n};`).join(" ");function Sr(t,r={}){if(b)return;let n=Jr();if(!n)return;if(!Lr(n,t))n.insertRule(`${t} { ${Ir(r)} }`,n.cssRules.length)}var er=(t,r=!1)=>{if(q(t))return[+t,yt(t)?"int":"float"];if(r&&/\.\w+$/.test(t))return[t,"file"];if(t==="/")return[t,"-"];if(t.length===36&&t.match(/\-/g)?.length===4)return[t,"uuid"];return[t,"string"]},ut=(t)=>{let r=t.startsWith("/")?t:"/"+t,n=r.match(/(?<=\/)[^/].*?(?=\/|$)/g)??["/"],[i,e]=n.reduce(([o,s],u)=>{if(u.includes("<")){let f=u.match(/(?<=<)[^/].*?(?=>|$)/g);if(f?.length){let[h,g]=f[0].split(":");if(h&&g)o.push(h),s.push(g)}}else o.push(u===">"?"/":u);return[o,s]},[[],[]]);if(r.endsWith("/")&&r.length>1)i.push("/");return{parsed:i,args:e}};class ft{storage=new m;cache(t,r){if(this.storage.lacks(t))this.storage.set(t,r());return this.storage.get(t)}}var Cr=["int","float","file","uuid","string"],Pr=new ft;class C{_storage=new m;set(t){let{parsed:r,path:n}=t,i=w(r);if(!this._storage.get(i))this._storage.set(i,t);else throw`path: ${n} already used.`}get(t){let{parsed:r}=Pr.cache(t,()=>ut(t)),n={},i=this._storage.get(w(r));if(!i&&t!=="/")for(let e of this._storage.keys()){let o=[],s=Kt(e);if(r.length===s.length){let u=s.map((g,R)=>{let H=er(r[R],r.length-1===R);if(g===H[0])return H[0];if(Cr.includes(H[1]))return o.push(H[0]),H[1];return g}),f=w(u);if(this._storage.has(f)){i=this._storage.get(f),i?.args.forEach((g,R)=>{n[g]=o[R]});break}}}return[i,n]}}class _{path="";parsed=[];args=[];constructor(t){et(this,{path:t,...ut(t)})}}class or{static rand(t=6,r){if(r)return Math.floor(Math.random()*(r-t+1)+t);return Math.floor(Math.random()*t)+1-1}static fill(t,r=null){return Array(t).fill(r)}static new({dom:t,id:r,inner:n}){let i=document.createElement(t);if(r)i.id=r;if(n)i.innerHTML=n;return i}static randFrom(t){if(Array.isArray(t)){let r=t.length,n=this.rand(0,r-1);return t[n]}else if(typeof t=="object"){let r=I(t),n=r.length,i=this.rand(0,n-1);return r[i]}}static randomAZ=Gt;static makeID=p;static class(t,r){let n=r;if(t?.class)n.push(...a(t.class)?t.class:[t.class]);t.class=r}static get O(){return{vals:E,keys:I,items:l,has:Vt,ass:d,len:(t={})=>I(t).length}}static get is(){return xt}static get return(){return sr}}class sr{static array(t){return a(t)?t:[t]}}var At={},Y={};class ur{stream;url;constructor(t,r){if(this.url=t,t in At)this.stream=At[t];else this.stream=new EventSource(t,{withCredentials:r}),At[t]=this.stream,Y[this.url]={}}on(t){let r=this.stream;return l(t).forEach(([n,i])=>{if(n in Y[this.url])Y[this.url][n].forEach((e)=>{this.stream.removeEventListener(n,e)}),Y[this.url][n]=[];if(r.addEventListener(n,i),!(n in Y[this.url]))Y[this.url][n]=[];Y[this.url][n].push(i)}),this}}function fr(t,r=!0){return new ur(t,r)}class mr{value;constructor(t){this.value=t}get str(){return String(this.value).toString()=="null"?null:String(this.value).toString()}get int(){if(q(this.value))return parseInt(this.value);else return null}get float(){if(q(this.value))return parseFloat(this.value);else return null}get bool(){if(this.value==="true")return!0;else if(this.value=="false")return!1;else return null}get json(){if(this.value)return JSON.parse(this.value);return null}}class k{key;func;storage;constructor(t,r="local"){if(typeof t=="object"){let[n,i]=l(t)[0];this.key=n,this.func=i}else this.key=t,this.func=null;this.storage=r=="local"?localStorage:sessionStorage}get as(){return new mr(this.storage.getItem(this.key))}get value(){return this.storage.getItem(this.key)}get save(){if(this.func)this.set=this.func();return}set set(t){if(typeof t=="object")this.storage.setItem(this.key,JSON.stringify(t));else this.storage.setItem(this.key,String(t))}get remove(){this.storage.removeItem(this.key);return}}var v={get:(t)=>new k(t)};var hr={get:(t)=>new k(t,"session")};class mt extends _{id;cls;constructor(t,r,n){super(t);this.id=r;this.cls=n}}class ar extends _{id;cls;constructor(t,r,n){super(t);this.id=r;this.cls=n}}class Rt extends jt{storage=new C;errorStorage=new C;wssStorage=new C;route;error;wss;base;constructor(t=""){super();this.base=t?t.startsWith("/")?t:`/${t}`:"",this.route=(r)=>{return(n)=>{return this.storage.set(new mt(this._base(r),p(5),n)),n}},this.wss=(r)=>{return(n)=>{return this.wssStorage.set(new ar(this._base(r),p(5),n)),n}},this.error=(...r)=>{return(n)=>{if(r.length)r.forEach((i)=>{this.errorStorage.set(new mt(i.toString(),p(5),n))});else this.errorStorage.set(new mt("404",p(5),n));return n}}}_base(t){return Nt(this.base,t)}async getPath(t){return this.storage.get(t)}async loadError(t){return this.errorStorage.get(t.toString())}async loadWSS(t){return this.wssStorage.get(t)}}var tt=new m,P=(t)=>{if(b)return;let r=tt.get(t);if(r?.isConnected)return r;tt.delete(t);let n=document.getElementById(t);if(!n)return;return tt.set(t,n),n};function lr(){let t=[];return tt.forEach((r,n)=>{if(!r.isConnected)t.push(n),tt.delete(n)}),t}function W(t,r,{id:n="state",init:i}={}){let e=[],o=()=>r.map((u)=>u.value),s=()=>{t(...o())};if(r.forEach((u)=>{e.push(u.hook(s)(n))}),i)s();return()=>{e.forEach((u)=>u())}}var cr=(t)=>{t.forEach((r)=>r())};var Wr=(t,r)=>{for(let[n,i]of t){let e=P(n);if(!e){t.delete(n);continue}i.forEach((o)=>{o.call(e,r)})}};class M extends EventTarget{options;hooks=new m;states=new m;_value;listening=!1;end;constructor(t,r){super();this.options=r;this._value=t}get value(){return this._value}set value(t){if(J(t)||bt(t))return;if(G(this._value)||a(this._value)){let r=Et(this._value,t);if(!kt(r))return}else if(this._value instanceof Set){if(!_t(this._value,t))return}else if(this._value===t)return;this._value=t,this.dispatchEvent(new CustomEvent("updated",{detail:this._value}))}get listen(){let t=(r)=>{if(cr(this.hooks),Wr(this.states,r.detail),!this.states.size&&!this.hooks.size)this.end?.()};if(!this.listening)this.addEventListener("updated",t,this.options),this.listening=!0;return()=>{this.listening&&this.removeEventListener("updated",t,this.options),this.end=void 0,this.listening=!1}}call(t,r){return(n)=>{if(ot(n,this.states).set(r,t),!b&&!this.listening)this.end=this.listen;return()=>{if(this.states.has(n))this.states.get(n)?.delete(r)}}}hook(t){return(r)=>{if(this.hooks.set(r,t),!b&&!this.listening)this.end=this.listen;return()=>{if(this.hooks.has(r))this.hooks.delete(r)}}}}function A(t){return new M(t)}var B=(t)=>{if(a(t))return t.filter((r)=>r!==void 0).join(" ");else if($(t)){if(it(t))return w(t)}else if(T(t))return B(t());else if(t!==void 0&&t!==null)return N(t)?t?"":"false":String(t);return""};function Br(t,r){switch(r??t){case"style":return function(n){this.style.setProperty(t,n)};default:return function(n){this.setAttribute(t,n)}}}class Ht{attr;constructor(t={}){this.attr=t}get(t,r=this.attr,n){let i=(e,o)=>{if(a(o))t.attr_push(e,B(o));else if(o instanceof M){let s=n?`${n}_${e}`:e;t.states.push(o.call(Br(e,n),s)),i(e,o.value)}else if($(o)){if(it(o)&&!n)this.get(t,o,e)}else t.attr_push(e,B(o),n)};l(r).forEach(([e,o])=>{if(e==="ref"){if(o instanceof ht)t.events.obj({element(){o.element=this}})}else if(["on"].includes(e))$(r.on)&&t.events.obj(r.on);else i(e,o)})}}class U{xid;IDM;map=new m;states=[];events=new m;OZ;constructor(t,r=new y,n){this.xid=t;this.IDM=r;this.OZ=n??new at}attr_push(t,r,n){let i=n??t;if(!this.map.has(i))this.map.set(i,[]);let e=n?`${F(t)}:${r};`:r;this.map.get(i).push(e)}get attr(){let t=[""];return this.map.forEach((r,n)=>{let i=r.join("");t.push(i?`${n}="${i}"`:n)}),t.join(" ")}set id(t){if(!this.map.has("id"))this.map.set("id",[t])}get id(){return this.map.get("id")?.join("")}}var Ur=(t,r,n)=>{return t.addEventListener(r,n),()=>{t.removeEventListener(r,n)}},rt={};class at{events=new m;states=new m;winStates=new m;windowEvents=new m;resetST=new m;resetEV=new m;constructor(){}get keys(){return[...new Set([...this.states.keys(),...this.events.keys()])]}set(t){let{id:r,events:n,states:i}=t;if(r){if(n.size)this.events.set(r,n);if(i.length)this.states.set(r,i)}return this}push(t){return t.events.forEach((r,n)=>{r.forEach((i,e)=>{ot(n,this.events).set(e,i)})}),t.states.forEach((r,n)=>{O(n,this.states).push(...r)}),this}get stage(){return this.events.forEach((t,r)=>{this.events.delete(r);let n=P(r);if(!n){this.events.delete(r);return}t.forEach((i,e)=>{switch(e){case"ready":case"element":i.apply(n,[n]);break;case"resize":case"beforeunload":case"popstate":case"winscroll":case"winload":case"winfocus":case"winblur":let o=e.replace(/^win/,"");this.windowEvents.init(o,new m).set(r,i);break;case"watch":let[s,u,f]=i.apply(n,[n]),h=a(u)?u:[u],g=()=>h.map((H)=>H.value),R=()=>s(...g());if(f)R();h.forEach((H)=>O(r,this.resetST).push(H.call(R,r+"_watch")(r)));break;default:O(r,this.resetEV).push(Ur(n,e,i))}})}),this.processWindowEvents,this.states.forEach((t,r)=>{this.states.delete(r),t.forEach((n)=>{O(r,this.resetST).push(n(r))})}),this}get processWindowEvents(){let t=(r,n)=>{let i=0,e=!1,o=(u)=>{if(i=window.scrollY,!e)window.requestAnimationFrame(()=>{n.forEach((f,h)=>{let g=P(h);if(g)f.call(g,u);else this.windowEvents.get(r)?.delete(h)}),e=!1}),e=!0},s=(u)=>{n.forEach((f,h)=>{let g=P(h);if(g)f.call(g,u);else this.windowEvents.get(r)?.delete(h)})};return window.addEventListener(r,r==="scroll"?o:s),()=>{window.removeEventListener(r,r==="scroll"?o:s)}};return this.windowEvents.forEach((r,n)=>{if(r.size){if(!rt[n])rt[n]=t(n,r)}else if(rt[n])rt[n](),delete rt[n]}),this}reset(t){return t.forEach((r)=>{this.windowEvents.forEach((n,i)=>{if(n.has(r))n.delete(r)}),this.resetEV.get(r)?.forEach((n)=>{n()}),this.resetST.get(r)?.forEach((n)=>{n()}),this.resetST.delete(r),this.resetEV.delete(r)}),this}RPS(t){if(t){let r=lr();this.reset(r);let n=t.keys;if(n.length)this.reset(n).push(t).stage}return this}}var D=new at;var zr=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],Kr=(t)=>zr.includes(t);function Gr(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var lt=(t,r)=>{if(a(t))return t.map((n)=>lt(n,r)).join("");else if(t instanceof z){let n=t.__(r.IDM),{ctx:i,oz:e}=n;return r.OZ.push(e),i}else if($(t))return w(t);else if(T(t))return lt(t(),r);else if(t!==void 0&&t!==null)return Gr(t);return""},ct=(t,r)=>{let n=new y(r),i=new U(n.id,n);return{ctx:lt(t,i),catt:i}};function Nr(t){let r=this.id;if(r){let{ctx:n,catt:i}=ct(t,r);if(this.innerHTML!==n)this.innerHTML=n,D.RPS(i.OZ)}}var Mt=(t,r,n,i=[])=>{if(a(t))t.forEach((e)=>{Mt(e,t.length,n,i)});else if(t instanceof M)if(r>1)Mt(Z("div",{},t),r,n,i);else{let e=t.value,o=e instanceof z?"dom":"ctx",{ctx:s,catt:u}=ct(e,n.xid+"-0");n.xid=u.xid,i.push(s),n.OZ.push(u.OZ),n.states.push(t.call(Nr,o))}else i.push(lt(t,n))};class Dt{tag;ctx;closing;constructor(t,r){this.tag=t;this.ctx=r;let n=Kr(t);this.closing=n?"":`</${t}>`}process(t,r=this.ctx,n=[]){return r.forEach((i)=>{Mt(i,r.length,t,n)}),n.join("")}get(t){let r=this.process(t);if(t.events.size||t.states.length)t.id=t.xid;return`<${this.tag}${t.attr}>${r}${this.closing}`}}class z{tag;constructor(t,r={},...n){this.tag=t;et(this,{attr:new Ht(r),ctx:new Dt(t,n)})}__(t=new y){let r=t.mid,n=new U(r,t);return this.attr.get(n),{ctx:this.ctx.get(n),oz:n.OZ.set(n),id:n.id}}}function Z(t,r={},...n){if(T(t))return t(r??{},...n);return new z(t,r??{},n)}var Vr=(t,...r)=>r;class qt{e;opt;constructor(t){this.e=t;this.opt={duration:500,easing:"ease-in-out",fill:"forwards"}}animate(t,r={}){return this.e.animate(t,r)}get slide(){let t=({x:r=0,y:n=0},i={})=>{d(this.opt,i);let e=[[r,n],[0,0]].map(([o,s])=>({transform:`translateX(${o}rem) translateY(${s}rem)`}));return this.e.animate(e,this.opt),this};return{left:(r={})=>{return t({x:-2},r)},right:(r={})=>{return t({x:2},r)},up:(r={})=>{return t({y:2},r)},down:(r={})=>{return t({y:-2},r)}}}fade(t={}){d(this.opt,t);let r=[0,1].map((n)=>({opacity:n}));return this.e.animate(r,this.opt),this}shake(t="Y",r={}){d(this.opt,r);let n=[0,5,-5,5,0].map((i)=>({transform:`translate${t}(${i}px)`}));return this.e.animate(n,this.opt),this}color(t=[],r={}){d(this.opt,r);let n=Array.isArray(t)?t.map((i)=>({color:i})):{color:t};return this.e.animate(n,this.opt),this}bg(t=[],r={}){d(this.opt,r);let n=Array.isArray(t)?t.map((i)=>({backgroundColor:i})):{backgroundColor:t};return this.e.animate(n,this.opt),this}bounce(t=1,r={}){d(this.opt,r);let n=[0.5,t,1].map((i)=>({transform:`scale(${i})`}));return this.e.animate(n),this}}class Ft{e;query;constructor(t,r){this.e=t;this.query=r}get a(){return new qt(this)}get all(){if(this.query){let t=document.querySelectorAll(this.query);if(t.length)return Array.from(t).map((r)=>r)}return[]}get attr(){let t=this.e;return{has:(r)=>{return t.hasAttribute(r)},get:(r)=>{return t.getAttribute(r)},del:(r)=>{return t.removeAttribute(r),this},set:(r)=>{for(let n in r){let i=r[n];if(r[n]!==void 0)t.setAttribute(n,B(i))}return this}}}get children(){return Array.from(this.e.children).map((t)=>c(t))}get click(){return this.e.click(),this}get delete(){return this.e.remove(),this}get disabled(){return this.e.disabled??!1}get focus(){return this.e.focus(),this}get href(){return this.e?.href??""}get id(){return this.e.id}get inner(){return this.e.innerHTML}get offsetParent(){let t=this.e.offsetParent;if(t)return new Q(t);return}get parent(){let t=this.e.parentElement;if(t)return new Q(t);return}get path(){return this.e?.pathname??""}get rect(){return this.e.getBoundingClientRect()}get remove_element(){return this.e.remove(),this}get style(){let t=this.e.style,r=this;return{set:(n,i=0)=>{let e=t,o=()=>{l(n).forEach(([s,u])=>{if(s in e){if(e[s]!==u)e[s]=u}else if(u!==null)t.setProperty(s,String(u))})};if(T(i))r.on("transitionend",i);if(Tt(i))setTimeout(o,i);else o();return r},get:(n)=>{return t.getPropertyValue(n.toString())},del:(...n)=>{n.forEach((i)=>{t.removeProperty(i.toString())})}}}get submit(){let t=this.e;if("submit"in t)return t.submit();return!1}get tag(){return this.e.tagName.toLowerCase()}get value(){return this.e.value??""}get unload(){return()=>{this.e.remove()}}set append(t){let{ctx:r,oz:n}=Zt(t,Qt(this.id));this.e.insertAdjacentHTML("beforeend",r),D.RPS(n)}set appendfirst(t){let{ctx:r,oz:n}=Zt(t,Qt(this.id));this.e.insertAdjacentHTML("afterbegin",r),D.RPS(n)}set inner(t){let{ctx:r,oz:n}=Zt(t,Qt(this.id));this.e.innerHTML=r,D.RPS(n)}set disabled(t){let r=this.e;if("disabled"in r)r.disabled=t}set id(t){this.e.id=t}set value(t){let r=this.e;r.value=t}}var Zt=(t,r)=>{let{ctx:n,catt:i}=ct(t,r);return{ctx:n,oz:i.OZ}},Qt=(t)=>t?`${t}-0`:t;class Q extends Ft{constructor(t,r){super(t,r)}add(...t){return this.e.classList.add(...t.map((r)=>r.replace(/[^\w-]/,""))),this}remove(...t){return this.e.classList.remove(...t.map((r)=>r.replace(/[^\w-]/,""))),this}toggle(t,r){let n=typeof t!="string"?t.apply(this):t,i=this.e.classList;return n.split(" ").forEach((e)=>{i.toggle(e,r)}),this}has(t){return this.e.contains(t)}insert(t){return{HTML:(...r)=>{return r.forEach((n)=>{this.e.insertAdjacentHTML(t,n)}),this},element:(...r)=>{return r.forEach((n)=>{this.e.insertAdjacentElement(t,n)}),this},text:function(...r){return r.forEach((n)=>{this.e.insertAdjacentText(t,n)}),this}}}is(t){let r=this.e.classList.value.split(" "),n=this.e.tagName.toLocaleLowerCase(),i=!0,e=!0;if(t.dom)e=t.dom==n?!0:!1;if(t.class)if(Array.isArray(t.class))t.class.forEach((o)=>{i=i?r.includes(o):!1});else i=i?r.includes(t.class):!1;return i&&e}on(t,r,n=!1){let i=!1;if(t.indexOf("touch")>-1)i=!0;return this.e.addEventListener(t,r,{capture:n,passive:i}),this}remove_on(t,r,n=!1){return this.e.removeEventListener(t,r,n),this}timed(t,r=250){return setTimeout(()=>t(this),r),this}animate(t,r,n){let i={duration:300,easing:"ease",fill:"forwards"};if(T(r))n=r;else d(i,r);let e=this.e.animate(t,i);if(n)e.finished.then(n);return this}}function c(t){if(V(t)){let r=document.querySelector(t);if(r)return new Q(r,t);return}else return new Q(t)}class ht{state=new M(void 0);constructor(){}get element(){return this.state.value?.e}set element(t){this.state.value=new Q(t)}get $(){return this.state.value}}var Or=()=>{return new ht};class gt extends $t{path;args;id;status;lang;import;_data={};constructor(t,r={},n,i=200){super();this.path=t;this.args=r;this.id=n;this.status=i}async loader(){if(this.import)try{let t=await this.import;if(t.default)this.import=await t.default({...this.args,...this.data});else this.import=void 0}catch(t){j.p=t,this.import=void 0}if(this.body){let t=await this.body();return a(t)?t:[t]}if(this.import){let t=this.import;return a(t)?t:[t]}return[]}getHeadAttr(t={},...r){let n=new S;if(x(t))n.head=t;n.id=this.id;let i=n.head;return r.forEach((e)=>{i.map(e)}),_r(n,this),i}set data(t){d(this._data,t)}get data(){return this._data}}class Xt extends gt{head(){this.title=`error ${this.status}`}body(){return Z("div",{},this.path+" not found...")}}function _r(t,r){let{link:n,script:i,meta:e,title:o,base:s,description:u,css:f}=r;if(t.head={title:o,base:s,meta:e,link:n,script:i},u)t.head={meta:[{name:"description",content:u}]};if(f){let g=(a(f)?f:[f]).map((R)=>({rel:"preload stylesheet",href:R,as:"style"}));t.head={link:[...g]}}}function gr(t){let r=[];if(t?.length){let{href:n,target:i}=t[0],e=c("base");if(e)e.attr.set({href:n,target:i});else{let o=c(document.createElement("base"));o.attr.set({href:n,target:i}),document.head.append(o.e)}}return r}var dr=new m;async function pr(t,r={},n=!1){let i=nt.value,e={};if(c("link")?.all.forEach((o)=>{let s=c(o),u=s.attr.get("href");if(u){let f=s.attr.get("rt");if(n){let h=dr.get(i);if(h){if(!h.has(u))e[u]=s.unload}else e[u]=s.unload}else if(f){if(f===t)e[u]=s.unload}}}),r&&x(r))for(let o of E(r)){let s=o.href;if(!(s in e))try{let u=void 0;if(!n){if(u=c(`link[href='${s}']`),u)u.attr.set({rt:t});o.rt=t;let f=dr.init(i,new Set);if(!f.has(s))f.add(s)}if(!u)await wt(o)}catch(u){j.p=u}else delete e[s]}return E(e)}var kr=["charset","name","property","http-equiv"];function Tr(t){let r={};if(c("meta")?.all.forEach((n)=>{let i=n.attributes;for(let e of kr)if(e in i){let o=i[e].value;r[`${e}_${e==="charset"?"":o}`]=n}}),t)l(t).forEach(([n,i])=>{if(n in r)c(r[n]).attr.set(i),delete r[n];else{let e=c(document.createElement("meta"));e.attr.set(i),document.head.append(e.e)}});return E(r).map((n)=>c(n).unload)}var br=new m;async function yr(t,r,n=!1){let i=nt.value,e={};if(c("script[yid]")?.all.forEach((o)=>{let s=c(o),u=s.attr.get("yid");if(u){let f=s.attr.get("rt");if(n){let h=br.get(i);if(h){if(!h.has(u))e[u]=s.unload}else e[u]=s.unload}else if(f){if(f===t)e[u]=s.unload}}}),r){for(let o of r)if("yid"in o)if(o.yid in e)delete e[o.yid];else try{if(!n){o.rt=t;let s=o.yid,u=br.init(i,new Set);if(!u.has(s))u.add(s)}await ir(o)}catch(s){j.p=s}}return E(e)}var dt="";async function xr(t,r,n=!1){let i=[];if(b)return[];let e=t.get("title")??"",{pushState:o}=this.config;if(o){let s=this.path.value;if(dt!==s){if(!dt.startsWith(s))pt(s,e),dt=s;else if(s===this.base)pt(s,e),dt=s}}if(!this.isYRA){if(e)document.title=e}else document.title=e;if(n)document.documentElement.lang=r,i.push(...gr(t.get("base"))),i.push(...Tr(t.get("meta")));return i.push(...await pr(this.id,t.get("link"),n)),i.push(...await yr(this.id,t.get("script"),n)),i}function pt(t,r){let n=window.location.pathname;if(t&&n!==t)history.pushState({},r??"",t)}class Yt{lang;head="";constructor(t,r){if(this.lang=t,r)this.head=nr(r)}body(t,r,n){return[`<!DOCTYPE html><html lang="${this.lang}">`,`<head>${this.head}</head>`,`<body id="${r??p(5)}"${n?" "+n:""}>${t}</body>`,"</html>"].join("")}}class Jt{path;args;isConnected=A(!1);data={};constructor(t,r={}){this.path=t;this.args=r}open(t){}message(t){}close(t){}error(t){}get connect(){if(this.ws&&this.ws.readyState<=1)return this;return this.ws=new WebSocket(this.path),this.ws.onopen=async(t)=>{this.isConnected.value=!0,await this.open.call(this,t)},this.ws.onmessage=async(t)=>{await this.message.call(this,t)},this.ws.onclose=async(t)=>{this.isConnected.value=!1,await this.close.call(this,t)},this.ws.onerror=async(t)=>{this.isConnected.value=this.ws.readyState<=1,await this.error.call(this,t)},this}get reconnect(){if(this.state>=2)this.connect;return this}get disconnect(){if(this.state<=1)this.ws.close();return this}get state(){return this.ws?.readyState??3}set send(t){this.ws.send(t)}}var K=new m;class Lt{yra;constructor(t){this.yra=t}async load(t){if(!K.has(t)){let[n,i]=await this.yra.loadWSS(t);if(!n)return;let{cls:e,path:o,id:s}=n,u=new e(o,i).connect;return K.set(t,u),u}let r=K.get(t);return r.reconnect,r}unload(t){if(K.has(t)){let r=K.get(t);if(!r)return;r.disconnect,K.delete(t)}}}function vr(t,r,n,i){let e={...t.on??{},click(o){o.preventDefault(),i.value=n.value,n.value=c(this).path}};return delete t.on,Z("a",{...t,on:{...e}},...r)}function tn(t,r,n){let{classes:i}=t.config,{on:e,...o}=r,s={...r.on??{},...{popstate(u){let f=u.target;if(f.location.pathname.includes(t.base))t.path.value=f.location.pathname},element(u){t.mainElement=this}}};return Z("div",{...o,...i&&{class:i},on:s},t.root)}var Er=new m;class It extends Rt{config;isYRA;unload=!1;hook;root=A([]);socket;id=p(4);path=A("");lastPath=A("");loading=A(!1);mainElement;A;Main;load;matchPath;constructor(t={},r=!1,n={}){super(t.base??"");this.config=t;this.isYRA=r;if(this.socket=new Lt(this),t.id)this.id=t.id;this.A=(i,...e)=>{if(this.base){if(!i.href.startsWith(this.base))i.href=this._base(i.href)}return vr(i,e,this.path,this.lastPath)},this.Main=(i)=>{if(x(n))if(!i.on)i.on=n;else d(i.on,n);return tn(this,i,r)},this.load=async(i,e={})=>{if(this.hook)this.hook();if(i)this.path.value=i,this.lastPath.value=i,await this.render(this.path.value,404,e),this.hooker();return this},this.matchPath=(i)=>{let e=this._base(i),o=this.path.value,s=this.base;if(o===e)return!0;else{let u=o.replace(s,""),f=e.replace(s,"");if(f){if(u.startsWith(f))return!0}else if(!o)return!0}return!1}}hooker(){let t={},r={},n=this.path.value;if(this.hook)this.hook();this.hook=W(async(i)=>{if(r[n]=window.scrollY,t[n]=this.mainElement?.scrollTop??0,(await this.render(i,404)).done){let e=r[i]??0;if(e)window.scrollTo({top:e,behavior:"instant"});let o=t[i]??0;if(o)this.mainElement?.scrollTo({top:o,behavior:"instant"});n=i}},[this.path],{id:"router"})}async class(t,r,n=!1){let[i,e]=await this.getPath(t);if(i&&!n){let{cls:o,id:s}=i;return new o(t,e,s)}else return await rn.call(this,t,r)}async fetch(t){if(t)try{if(t.fetch){let r=await t.fetch();if(G(r)&&x(r))t.data=r}}catch(r){j.p=r}}async processHead(t,r={}){return t?await this.processClassHead(t,r):await this.processDefaultHead(r)}async processClassHead(t,r){if(t.head)await t.head();return t.getHeadAttr(r,this.htmlHead)}async processDefaultHead(t){let r=new S;if(x(t))r.head=t;return r.head.map(this.htmlHead),r.head}async render(t,r=404,n={},i={},e=!0,o=!1){let s=await this.class(t,r??en(),o);s.data=n,await this.fetch(s);let u=await this.processHead(s,i);if(!s)return{lang:this.lang,heads:u,done:!1};let f=[];if(this.loading.value=!0,this.unload)f=await s.loader();let h=[];if(e)h=await xr.call(this,u,s?.lang||this.lang,this.unload);if(!this.unload)h.forEach((g)=>g()),f=await s.loader(),Er=u;if(this.unload)h.forEach((g)=>g());if(f.length)this.root.value=f;else await this.render(t,r,n,i,e,!0);return this.loading.value=!1,{heads:u,lang:s.lang??this.lang,done:!0}}}async function rn(t,r){let[n,i]=await this.loadError(r??0);if(n){let{cls:e,id:o}=n;return new e(t,i,o,r)}else{let e=new Xt(t,i,p(5));return e.title=`error ${r}`,e}}var nt=A("");class $r extends It{ImportMeta;config;unload=!0;constructor(t,r={},n={}){super(r,!0,n);this.ImportMeta=t;this.config=r;this.path=nt,this.head({meta:[{charset:"utf-8"},{name:"viewport",content:"width=device-width, initial-scale=1.0"}]}),this.load=async(i,e={})=>{if(L)i=on()||this._base(i??"/");if(this.hook)this.hook();if(i)this.path.value=i;if(L&&i)try{if(await this.render(i,404,e),i&&this.config.pushState)pt(i,document.title);nn.call(this,this.Main({})),this.hooker()}catch(o){j.p=o}return this}}async html({path:t,data:r={},status:n=200,attr:i=""}){let{base:e,ImportMeta:o}=this,s={base:[{href:e==="/"?e:`${e}/`,target:"_blank"}],script:[{type:"module",src:`${o.file}`}]};sn(s,t,n),this.path.value=t;let{lang:u,heads:f}=await this.render(t,n,r,s,!1);d(f.init("link",{}),Er.get("link")??{});let{ctx:h}=this.Main({}).__(new y(this.id));return new Yt(u,f).body(h,this.id,i)}}function nn(t){let r=document.body.id,{oz:n,id:i}=t.__(new y(r));if(this.id=i||this.id,!n)return;D.push(n),requestAnimationFrame(()=>{D.stage})}function en(){if(L)return parseInt(c('meta[name="error-code"]')?.attr.get("content")??"404");return 404}function on(){if(L)return c('meta[name="yvee"]')?.attr.get("content")??"/";return""}var sn=(t,r,n)=>{let i=[];if(n)switch(n){case 404:i.push({name:"error-code",content:n.toString()});break;default:break}i.push({name:"yvee",content:r}),t.meta=i},un=(t)=>{return(r)=>{t(r)}},fn=(t)=>{return(r)=>{t(r)}};class St{state;body;click;constructor({toggle:t=[],initialState:r=!1}={}){this.state=A(r);let n=this.state;this.click=function(){n.value=!n.value},this.loader(t)}loader(t){if(typeof window==="undefined")return;let r=v.get("LOCAL_SCHEME"),n=this.isDark,i=r.as.bool,e=v.get({IS_DARK:()=>this.state.value});if(i!=null&&i!==n)this.state.value=!i,e.save,r.set=n;if(e.as.bool!==null)this.state.value=e.as.bool;let o=this.toggle,s=document.documentElement.classList;if(o(s,this.state.value,t),W(async(u)=>{o(s,u,t),e.save},[this.state],{id:"colorScheme"}),this.isMatchMediaSupported)window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(u)=>{let h=(u.matches?"dark":"light")==="dark";this.state.value=h,r.set=h})}get isMatchMediaSupported(){return window.matchMedia&&typeof window.matchMedia==="function"}get isDark(){return window.matchMedia("(prefers-color-scheme: dark)").matches}toggle(t,r,n){if(r)t.add(...n);else t.remove(...n)}}St=Ct([vt,Pt("design:paramtypes",[Object])],St);var Rs=(t,r)=>{return`${t.replace(/\/+$/,"")}/${r.replace(/^\.\/+/,"")}`};export{Jt as websocket,Or as useRef,W as stateHook,hr as session,Rs as resolvePath,v as local,Vr as frag,fr as eventStream,Z as dom,gt as doc,wt as cssLoader,Sr as addCSS,or as __,$r as Yvee,M as Stateful,A as State,un as Routes,It as Router,st as Meta,fn as Errors,z as Dom,St as ColorScheme,j as $$,c as $};
