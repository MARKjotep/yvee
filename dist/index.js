var Zn=Object.defineProperty;var Hn=(t,n)=>{for(var r in n)Zn(t,r,{get:n[r],enumerable:!0,configurable:!0,set:(i)=>n[r]=()=>i})};var jt={};Hn(jt,{isWindow:()=>K,isUndefined:()=>bt,isStr:()=>_,isPromise:()=>Ln,isPlainObject:()=>V,isObj:()=>H,isNumber:()=>X,isNum:()=>ct,isNull:()=>A,isNotWindow:()=>E,isNotNull:()=>Jn,isInt:()=>$t,isFN:()=>j,isDict:()=>et,isDefined:()=>Xn,isClassOrId:()=>Mn,isBool:()=>O,isAsync:()=>Yn,isArraybuff:()=>Fn,isArr:()=>l});var j=(t)=>typeof t==="function",Yn=(t)=>t.constructor.name==="AsyncFunction",Ln=(t)=>!!t&&typeof t.then==="function",X=(t)=>{return!isNaN(parseFloat(t))&&isFinite(t)},et=(t)=>{return typeof t==="object"&&t!==null&&!Array.isArray(t)},V=(t)=>{return typeof t==="object"&&t!==null&&Object.getPrototypeOf(t)===Object.prototype},Fn=(t)=>{return t instanceof Uint8Array||t instanceof ArrayBuffer||typeof t==="string"},Mn=(t)=>{return t.startsWith(".")||t.startsWith("#")},O=(t)=>typeof t==="boolean",_=(t)=>typeof t==="string",l=(t)=>Array.isArray(t),H=(t)=>typeof t==="object",ct=(t)=>typeof t==="number",A=(t)=>t===null,Jn=(t)=>t===null,bt=(t)=>typeof t==="undefined",Xn=(t)=>typeof t!=="undefined",$t=(t)=>{return Number.isInteger(Number(t))},K=typeof window!=="undefined",E=typeof window==="undefined";function st(t,n){T(n).forEach(([r,i])=>{zt(t,r,{value:i,writable:!1,configurable:!1,enumerable:!0})})}var qt=(t)=>{return l(t)?t:[t]};class q{static set i(t){console.info(...qt(t))}static set e(t){console.error(...qt(t))}static set w(t){console.info(...qt(t))}}class Y{_c=0;_id="";constructor(t){if(this._c=0,this._id=t??b(5),t?.includes("-")){let[n,r]=[t.split("-").slice(0,-1).join("-"),t.split("-").slice(-1)[0]];this._id=n,this._c=X(r)?parseInt(r):0}}get id(){return this._id+"-"+this._c}get mid(){return this._id+"-"+ ++this._c}}var Qn=(t)=>Array.from({length:t},(n,r)=>r),Pt="ABCDEFGHIJKLMNOPQRSTUVWXYZ",dt="abcdefghijklmnopqrstuvwxyz";var L=(t)=>JSON.stringify(t),Rt=(t)=>{return JSON.parse(t)},D=(t)=>{if(t.startsWith("webkit"))t="-"+t;return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},b=(t)=>{let n=Pt+dt,r=Qn(10).join("");return Array.from({length:t},(i,o)=>n+(o?r:"")).reduce((i,o)=>{return i+=o.charAt(Math.floor(Math.random()*o.length))},"")},Un=(t=6,n)=>{if(!n)return Math.floor(Math.random()*t);return Math.round(Math.random()*(n-t)+t)},Ct=()=>{let t=[...Pt,...dt],n=Un(0,t.length);return t[n]};var Nt=(t,n)=>{let r=n==="/"?"":n;if(n.startsWith("#"))return t+n;return n.startsWith("/")?t+r:n};class m extends Map{obj(t){t&&T(t).forEach(([n,r])=>this.set(n,r))}map(t){t.forEach((n,r)=>{if(n instanceof m)this.set(r,n);else if(l(n)){if(this.lacks(r))this.set(r,[]);this.get(r).push(...n)}else if(H(n))this.ass(r,n);else this.set(r,n)})}ass(t,n){if(!this.has(t))this.set(t,{});y(this.get(t),n)}lacks(t){return!this.has(t)}init(t,n){return this.has(t)?this.get(t):this.set(t,n).get(t)}}var{values:Z,keys:B,entries:T}=Object;var{defineProperty:zt,assign:y}=Object,Vt=(t,n)=>Object.hasOwn(t,n),S=(t)=>{return Object.keys(t).length},ft=(t,n)=>{if(!n.has(t))n.set(t,new m);return n.get(t)},a=(t,n)=>{if(!n.has(t))n.set(t,[]);return n.get(t)},St=(t,n)=>{let r={added:{},removed:{},modified:{}},i=B(t),o=B(n);for(let e of o){let s=t[e],f=n[e];if(!(e in t))r.added[e]=f;else if(l(s)&&l(f)){if(L(s)!==L(f))r.modified[e]={old:s,new:f}}else if(H(s)&&H(f)&&!A(s)&&!A(f)){let u=St(s,f);if(S(u.added)||S(u.removed)||S(u.modified))r.modified[e]={old:s,new:f}}else if(s!==f)r.modified[e]={old:s,new:f}}for(let e of i)if(!(e in n))r.removed[e]=t[e];return r};function Ot(t,n){if(t.size!==n.size)return!1;for(let r of t)if(!n.has(r))return!1;return!0}var _t=(t)=>{return Z(t).some((n)=>{return S(n)})};var I=(t,n)=>{return{name:t,content:n}},pn=(t,n)=>{return{property:t,content:n}},Gn=(t,n)=>{return{"http-equiv":t,content:n}};class k{metas=[];constructor(t){t&&this.metas.push(I("description",t))}author(t){return this.meta=I("author",t),this}charset(t){return this.meta={charset:t},this}keywords(...t){return this.meta=I("keywords",t.join(", ")),this}viewport(t){let n=T(t).map(([r,i])=>[D(r),String(i)].join("="));return this.meta=I("viewport",n.join(", ")),this}httpEquiv(t){return T(t).forEach(([n,r])=>{this.meta=Gn(D(n),String(r))}),this}robots(...t){return this.meta=I("robots",t.join(", ")),this}themeColor(t){return this.meta=I("theme-color",t),this}openGraph(t){return T(t).forEach(([n,r])=>{this.meta=pn("og:"+n,String(r))}),this}twitter(t){return T(t).forEach(([n,r])=>{this.meta=I("twitter:"+n,String(r))}),this}and(t){return this}set meta(t){this.metas.push(t)}}class Ht{title;description;base;meta;link;script;css}var Dn=["charset","name","property","http-equiv"],at=(t,n)=>{n.forEach((r)=>{for(let i of Dn)if(i in r){let o=r[i];t[`${i}_${i==="charset"?"":o}`]=r}})},In=(t,n)=>{n.forEach((r)=>{if("href"in r){let i=r.href;t[`${i}`]=r}})};class W{_head;idm;constructor(t){this._head=new m(t)}set head(t){T(t).forEach(([n,r])=>{if(n==="title"||n==="base"){if(r!==void 0)this._head.set(n,r);return}if(r instanceof k)return at(this._head.init("meta",{}),r.metas);if(!l(r))return;switch(n){case"meta":return at(this._head.init("meta",{}),r);case"link":return In(this._head.init("link",{}),r);case"script":if(r.length){this._head.init(n,[]);let i=r.map((o)=>{if(!o.yid&&this.idm)o.yid="sc"+this.idm.mid;return o});this._head.get(n).push(...i)}return}})}get head(){return this._head}set id(t){this.idm=new Y(t)}}var Zt=(t)=>{return T(t).reduce((n,[r,i])=>{return n.push(O(i)&&i?r:`${r}="${i}"`),n},[""]).join(" ")},kt=(t)=>{if(!t)return"";return[...[...t].reduce((r,[i,o])=>{if(i==="meta"||i==="link")o=Z(o);if(_(o))return r.add(`<${i}>${o}</${i}>`),r;if(!l(o))return r;if(i==="base"){let s=o.slice(-1);if(s)return r.add(`<${i}${Zt(s[0])}>`),r}return o.map((s)=>{if(i==="script"){let f={...s},u="";if("importmap"in f)f.type="importmap",u=JSON.stringify(f.importmap),delete f.importmap;else if("body"in f)u=f.body,delete f.body;return`<${i}${Zt(f)}>${u}</${i}>`}return`<${i}${Zt(s)}>`}).forEach((s)=>{r.add(s)}),r},new Set)].join(" ")};class Yt{lang="en";htmlHead;head;constructor(){this.htmlHead=new m,this.head=(t={})=>{let n=new W(this.htmlHead),{css:r,description:i,...o}=t;if(i)n.head={meta:[{name:"description",content:i}]};if(r){let s=(l(r)?r:[r]).map((f)=>({rel:"preload stylesheet",href:f,as:"style"}));n.head={link:[...s]}}n.head=o,this.htmlHead=n.head}}}var Lt=(t)=>{if(E)return;return new Promise((n,r)=>{let i=document.createElement("link");if(t.rel!=="stylesheet")t.rel="stylesheet",t.as="style";T(t).forEach(([o,e])=>{i.setAttribute(o,e)}),i.onload=()=>n(i),i.onerror=()=>r(new Error("Failed to load CSS")),document.head.appendChild(i)})},vt=(t)=>{if(E)return;return new Promise((n,r)=>{let i=document.createElement("script"),o="";if("importmap"in t)t.type="importmap",o=JSON.stringify(t.importmap),delete t.importmap;else if("body"in t)o=t.body,delete t.body;if(o)i.textContent=o;T(t).forEach(([e,s])=>{i.setAttribute(e,s)}),i.onload=()=>n(i),i.onerror=()=>r(new Error("Failed to load Script")),document.head.appendChild(i),requestAnimationFrame(()=>n("Script executed"))})},wn=()=>{let n=document.querySelector("#d-css")?.sheet;if(n)return n;let r=document.createElement("style");return r.id="d-css",document.head.appendChild(r),r.sheet},An=(t,n)=>{for(let r=0;r<t.cssRules.length;r++)if(t.cssRules[r].selectorText===n)return!0;return!1},Kn=(t)=>Object.entries(t).map(([n,r])=>`${D(n)}: ${r};`).join(" ");function Bn(t,n={}){if(E)return;let r=wn();if(!r)return;if(!An(r,t))r.insertRule(`${t} { ${Kn(n)} }`,r.cssRules.length)}var tn=(t,n=!1)=>{if(X(t))return[+t,$t(t)?"int":"float"];if(n&&/\.\w+$/.test(t))return[t,"file"];if(t==="/")return[t,"-"];if(t.length===36&&t.match(/\-/g)?.length===4)return[t,"uuid"];return[t,"string"]},ut=(t)=>{let n=t.startsWith("/")?t:"/"+t,r=n.match(/(?<=\/)[^/].*?(?=\/|$)/g)??["/"],[i,o]=r.reduce(([e,s],f)=>{if(f.includes("<")){let u=f.match(/(?<=<)[^/].*?(?=>|$)/g);if(u?.length){let[g,h]=u[0].split(":");if(g&&h)e.push(g),s.push(h)}}else e.push(f===">"?"/":f);return[e,s]},[[],[]]);if(n.endsWith("/")&&n.length>1)i.push("/");return{parsed:i,args:o}};class mt{storage;constructor(){this.storage=new m}cache(t,n){if(this.storage.lacks(t))this.storage.set(t,n());return this.storage.get(t)}}var Wn=["int","float","file","uuid","string"];class z{_storage;CC;constructor(){this._storage=new m,this.CC=new mt}set(t){let{parsed:n,path:r}=t,i=L(n);if(!this._storage.get(i))this._storage.set(i,t);else throw`path: ${r} already used.`}get(t){let{parsed:n}=this.CC.cache(t,()=>ut(t)),r={},i=this._storage.get(L(n));if(!i&&t!=="/")for(let o of this._storage.keys()){let e=[],s=Rt(o);if(n.length===s.length){let f=s.map((h,c)=>{let $=tn(n[c],n.length-1===c);if(h===$[0])return $[0];if(Wn.includes($[1]))return e.push($[0]),$[1];return h}),u=L(f);if(this._storage.has(u)){i=this._storage.get(u),i?.args.forEach((h,c)=>{r[h]=e[c]});break}}}return[i,r]}}class v{path="";parsed=[];args=[];constructor(t){st(this,{path:t,...ut(t)})}}class nn{static rand(t=6,n){if(n)return Math.floor(Math.random()*(n-t+1)+t);return Math.floor(Math.random()*t)+1-1}static fill(t,n=null){return Array(t).fill(n)}static new({dom:t,id:n,inner:r}){let i=document.createElement(t);if(n)i.id=n;if(r)i.innerHTML=r;return i}static randFrom(t){if(Array.isArray(t)){let n=t.length,r=this.rand(0,n-1);return t[r]}else if(typeof t=="object"){let n=B(t),r=n.length,i=this.rand(0,r-1);return n[i]}}static randomAZ=Ct;static makeID=b;static class(t,n){let r=n;if(t?.class)r.push(...l(t.class)?t.class:[t.class]);t.class=n}static get O(){return{vals:Z,keys:B,items:T,has:Vt,ass:y,len:(t={})=>B(t).length}}static get is(){return jt}static get return(){return rn}static sleep=(t=1000)=>new Promise((n)=>setTimeout(n,t));static get screen(){let{innerWidth:t}=window,n={xs:t<=480,sm:t>=480,smd:t>=624,md:t>=768,lg:t>=1024,xl:t>=1280,xxl:t>=1536},r=T(n).reverse();for(let i=0;i<r.length;i++){let[o,e]=r[i];if(e)return o}return}}class rn{static array(t){return l(t)?t:[t]}}var Ft={},w={};class on{stream;url;constructor(t,n){if(this.url=t,t in Ft)this.stream=Ft[t];else this.stream=new EventSource(t,{withCredentials:n}),Ft[t]=this.stream,w[this.url]={}}on(t){let n=this.stream;return T(t).forEach(([r,i])=>{if(r in w[this.url])w[this.url][r].forEach((o)=>{this.stream.removeEventListener(r,o)}),w[this.url][r]=[];if(n.addEventListener(r,i),!(r in w[this.url]))w[this.url][r]=[];w[this.url][r].push(i)}),this}}function en(t,n=!0){return new on(t,n)}class sn{value;constructor(t){this.value=t}get str(){return String(this.value).toString()=="null"?null:String(this.value).toString()}get int(){if(X(this.value))return parseInt(this.value);else return null}get float(){if(X(this.value))return parseFloat(this.value);else return null}get bool(){if(this.value==="true")return!0;else if(this.value=="false")return!1;else return null}get json(){if(this.value)return JSON.parse(this.value);return null}}class tt{key;func;storage;constructor(t,n="local"){if(typeof t=="object"){let[r,i]=T(t)[0];this.key=r,this.func=i}else this.key=t,this.func=null;this.storage=n=="local"?localStorage:sessionStorage}get as(){return new sn(this.storage.getItem(this.key))}get value(){return this.storage.getItem(this.key)}get save(){if(this.func)this.set=this.func();return}set set(t){if(typeof t=="object")this.storage.setItem(this.key,JSON.stringify(t));else this.storage.setItem(this.key,String(t))}get remove(){this.storage.removeItem(this.key);return}}var fn={get:(t)=>new tt(t)};var un={get:(t)=>new tt(t,"session")};class gt extends v{id;cls;constructor(t,n,r){super(t);this.id=n;this.cls=r}}class mn extends v{id;cls;constructor(t,n,r){super(t);this.id=n;this.cls=r}}class Mt extends Yt{storage=new z;errorStorage=new z;wssStorage=new z;route;error;wss;base;constructor(t=""){super();this.base=t?t.startsWith("/")?t:`/${t}`:"",this.route=(n)=>{let r=this._base(n);return(i)=>{return i.route=r,this.storage.set(new gt(r,b(5),i)),i}},this.wss=(n)=>{let r=this._base(n);return(i)=>{return i.route=r,this.wssStorage.set(new mn(r,b(5),i)),i}},this.error=(...n)=>{return(r)=>{if(n.length)n.forEach((i)=>{this.errorStorage.set(new gt(i.toString(),b(5),r))});else this.errorStorage.set(new gt("404",b(5),r));return r}}}_base(t){return Nt(this.base,t)}async getPath(t){return this.storage.get(t)}async loadError(t){return this.errorStorage.get(t.toString())}async loadWSS(t){return this.wssStorage.get(t)}}var nt=new m,P=(t)=>{if(E)return;let n=nt.get(t);if(n?.isConnected)return n;nt.delete(t);let r=document.getElementById(t);if(!r)return;return nt.set(t,r),r};function gn(){let t=[];return nt.forEach((n,r)=>{if(!n.isConnected)t.push(r),nt.delete(r)}),t}function lt(t,n,{id:r="state",init:i}={}){let o=[],e=()=>n.map((f)=>f.value),s=()=>{t(...e())};if(n.forEach((f)=>{o.push(f.hook(s)(r))}),i)s();return()=>{o.forEach((f)=>f())}}var ln=(t)=>{t.forEach((n)=>n())};function hn(t,n,{id:r="state",init:i}={}){return lt(t,n)}var zn=(t,n)=>{for(let[r,i]of t){let o=P(r);if(!o){t.delete(r);continue}i.forEach((e)=>{e.call(o,n)})}};class F extends EventTarget{options;hooks=new m;states=new m;_value;listening=!1;end;constructor(t,n){super();this.options=n;this._value=t}get value(){return this._value}set value(t){if(A(t)||bt(t))return;if(V(this._value)||l(this._value)){let n=St(this._value,t);if(!_t(n))return}else if(this._value instanceof Set){if(!Ot(this._value,t))return}else if(this._value===t)return;this._value=t,this.dispatchEvent(new CustomEvent("updated",{detail:this._value}))}get listen(){let t=(n)=>{if(ln(this.hooks),zn(this.states,n.detail),!this.states.size&&!this.hooks.size)this.end?.()};if(!this.listening)this.addEventListener("updated",t,this.options),this.listening=!0;return()=>{this.listening&&this.removeEventListener("updated",t,this.options),this.end=void 0,this.listening=!1}}call(t,n){return(r)=>{if(ft(r,this.states).set(n,t),!E&&!this.listening)this.end=this.listen;return()=>{if(this.states.has(r))this.states.get(r)?.delete(n)}}}hook(t){return(n)=>{if(this.hooks.set(n,t),!E&&!this.listening)this.end=this.listen;return()=>{if(this.hooks.has(n))this.hooks.delete(n)}}}}function M(t){return new F(t)}var d=(t)=>{if(l(t))return t.filter((n)=>n!==void 0).join(" ");else if(H(t)){if(et(t))return L(t)}else if(j(t))return d(t());else if(t!==void 0&&t!==null)return O(t)?t?"":"false":String(t);return""};function Pn(t,n){switch(n??t){case"style":return function(r){this.style.setProperty(t,r)};default:return function(r){this.setAttribute(t,r)}}}class Jt{attr;constructor(t={}){this.attr=t}get(t,n=this.attr,r){let i=(o,e)=>{if(l(e))t.attr_push(o,d(e));else if(e instanceof F){let s=r?`${r}_${o}`:o;t.states.push(e.call(Pn(o,r),s)),i(o,e.value)}else if(H(e)){if(et(e)&&!r)this.get(t,e,o)}else t.attr_push(o,d(e),r)};T(n).forEach(([o,e])=>{if(o==="ref"){if(e instanceof ht)t.events.obj({element(){e.element=this}})}else if(["on"].includes(o))H(n.on)&&t.events.obj(n.on);else i(o,e)})}}class Q{xid;IDM;map=new m;states=[];events=new m;OZ;constructor(t,n=new Y,r){this.xid=t;this.IDM=n;this.OZ=r??new Tt}attr_push(t,n,r){let i=r??t;if(!this.map.has(i))this.map.set(i,[]);let o=r?`${D(t)}:${n};`:n;this.map.get(i).push(o)}get attr(){let t=[""];return this.map.forEach((n,r)=>{let i=n.join("");t.push(i?`${r}="${i}"`:r)}),t.join(" ")}set id(t){if(!this.map.has("id"))this.map.set("id",[t])}get id(){return this.map.get("id")?.join("")}}var dn=(t,n,r)=>{return t.addEventListener(n,r),()=>{t.removeEventListener(n,r)}},rt={};class Tt{events=new m;states=new m;winStates=new m;windowEvents=new m;resetST=new m;resetEV=new m;constructor(){}get keys(){return[...new Set([...this.states.keys(),...this.events.keys()])]}set(t){let{id:n,events:r,states:i}=t;if(n){if(r.size)this.events.set(n,r);if(i.length)this.states.set(n,i)}return this}push(t){return t.events.forEach((n,r)=>{n.forEach((i,o)=>{ft(r,this.events).set(o,i)})}),t.states.forEach((n,r)=>{a(r,this.states).push(...n)}),this}get stage(){return this.events.forEach((t,n)=>{this.events.delete(n);let r=P(n);if(!r){this.events.delete(n);return}t.forEach((i,o)=>{switch(o){case"ready":case"element":i.apply(r,[r]);break;case"resize":case"beforeunload":case"popstate":case"winscroll":case"winload":case"winfocus":case"winblur":let e=o.replace(/^win/,"");this.windowEvents.init(e,new m).set(n,i);break;case"observe":case"watch":let[s,f,u]=i.apply(r,[r]),g=l(f)?f:[f],h=()=>g.map(($)=>$.value),c=()=>s(...h());if(u)c();g.forEach(($)=>a(n,this.resetST).push($.call(c,n+"_watch")(n)));break;default:a(n,this.resetEV).push(dn(r,o,i))}})}),this.processWindowEvents,this.states.forEach((t,n)=>{this.states.delete(n),t.forEach((r)=>{a(n,this.resetST).push(r(n))})}),this}get processWindowEvents(){let t=(n,r)=>{let i=0,o=!1,e=(f)=>{if(i=window.scrollY,!o)window.requestAnimationFrame(()=>{r.forEach((u,g)=>{let h=P(g);if(h)u.call(h,f);else this.windowEvents.get(n)?.delete(g)}),o=!1}),o=!0},s=(f)=>{r.forEach((u,g)=>{let h=P(g);if(h)u.call(h,f);else this.windowEvents.get(n)?.delete(g)})};return window.addEventListener(n,n==="scroll"?e:s),()=>{window.removeEventListener(n,n==="scroll"?e:s)}};return this.windowEvents.forEach((n,r)=>{if(n.size){if(!rt[r])rt[r]=t(r,n)}else if(rt[r])rt[r](),delete rt[r]}),this}reset(t){return t.forEach((n)=>{this.windowEvents.forEach((r,i)=>{if(r.has(n))r.delete(n)}),this.resetEV.get(n)?.forEach((r)=>{r()}),this.resetST.get(n)?.forEach((r)=>{r()}),this.resetST.delete(n),this.resetEV.delete(n)}),this}RPS(t){if(t){let n=gn();this.reset(n);let r=t.keys;if(r.length)this.reset(r).push(t).stage}return this}}var J=new Tt;var Rn=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],Cn=(t)=>Rn.includes(t);function Nn(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var xt=(t,n)=>{if(l(t))return t.map((r)=>xt(r,n)).join("");else if(t instanceof R){let r=t.__(n.IDM),{ctx:i,oz:o}=r;return n.OZ.push(o),i}else if(H(t))return L(t);else if(j(t))return xt(t(),n);else if(t!==void 0&&t!==null)return Nn(t);return""},yt=(t,n)=>{let r=new Y(n),i=new Q(r.id,r);return{ctx:xt(t,i),catt:i}};function Vn(t){let n=this.id;if(n){let{ctx:r,catt:i}=yt(t,n);if(this.innerHTML!==r)this.innerHTML=r,J.RPS(i.OZ)}}var it=(t,n,r,i=[])=>{if(l(t))t.forEach((o)=>{it(o,t.length,r,i)});else if(t instanceof F)if(n>1)it(U("div",{},t),n,r,i);else{let o=t.value,e=o instanceof R?"dom":"ctx",{ctx:s,catt:f}=yt(o,r.xid+"-0");r.xid=f.xid,i.push(s),r.OZ.push(f.OZ),r.states.push(t.call(Vn,e))}else i.push(xt(t,r))};class Xt{tag;ctx;closing;constructor(t,n){this.tag=t;this.ctx=n;let r=Cn(t);this.closing=r?"":`</${t}>`}process(t,n=this.ctx,r=[]){return n.forEach((i)=>{it(i,n.length,t,r)}),r.join("")}get(t){let n=this.process(t);if(t.events.size||t.states.length)t.id=t.xid;return`<${this.tag}${t.attr}>${n}${this.closing}`}}class R{tag;constructor(t,n={},...r){this.tag=t;st(this,{attr:new Jt(n),ctx:new Xt(t,r)})}__(t=new Y){let n=t.mid,r=new Q(n,t);return this.attr.get(r),{ctx:this.ctx.get(r),oz:r.OZ.set(r),id:r.id}}}function U(t,n={},...r){if(j(t))return t(n??{},...r);return new R(t,n??{},r)}var On=(t,...n)=>n;class Qt{e;opt;constructor(t){this.e=t;this.opt={duration:500,easing:"ease-in-out",fill:"forwards"}}animate(t,n={}){return this.e.animate(t,n)}get slide(){let t=({x:n=0,y:r=0},i={})=>{y(this.opt,i);let o=[[n,r],[0,0]].map(([e,s])=>({transform:`translateX(${e}rem) translateY(${s}rem)`}));return this.e.animate(o,this.opt),this};return{left:(n={})=>{return t({x:-2},n)},right:(n={})=>{return t({x:2},n)},up:(n={})=>{return t({y:2},n)},down:(n={})=>{return t({y:-2},n)}}}fade(t={}){y(this.opt,t);let n=[0,1].map((r)=>({opacity:r}));return this.e.animate(n,this.opt),this}shake(t="Y",n={}){y(this.opt,n);let r=[0,5,-5,5,0].map((i)=>({transform:`translate${t}(${i}px)`}));return this.e.animate(r,this.opt),this}color(t=[],n={}){y(this.opt,n);let r=Array.isArray(t)?t.map((i)=>({color:i})):{color:t};return this.e.animate(r,this.opt),this}bg(t=[],n={}){y(this.opt,n);let r=Array.isArray(t)?t.map((i)=>({backgroundColor:i})):{backgroundColor:t};return this.e.animate(r,this.opt),this}bounce(t=1,n={}){y(this.opt,n);let r=[0.5,t,1].map((i)=>({transform:`scale(${i})`}));return this.e.animate(r),this}}class Gt{e;query;constructor(t,n){this.e=t;this.query=n}get a(){return new Qt(this)}get all(){if(this.query){let t=document.querySelectorAll(this.query);if(t.length)return Array.from(t).map((n)=>n)}return[]}get attr(){let t=this.e;return{has:(n)=>{return t.hasAttribute(n)},get:(n)=>{return t.getAttribute(n)},del:(n)=>{return t.removeAttribute(n),this},set:(n)=>{for(let r in n){let i=n[r];if(n[r]!==void 0)t.setAttribute(r,d(i))}return this}}}get children(){return Array.from(this.e.children).map((t)=>x(t))}get click(){return this.e.click(),this}get delete(){return this.e.remove(),this}get disabled(){return this.e.disabled??!1}get focus(){return this.e.focus(),this}get href(){return this.e?.href??""}get id(){return this.e.id}get inner(){return this.e.innerHTML}get offsetParent(){let t=this.e.offsetParent;if(t)return new p(t);return}get parent(){let t=this.e.parentElement;if(t)return new p(t);return}get hash(){return this.e?.hash??""}get path(){return this.e?.pathname??""}get rect(){return this.e.getBoundingClientRect()}get remove_element(){return this.e.remove(),this}get style(){let t=this.e.style,n=this;return{set:(r,i=0)=>{let o=t,e=()=>{T(r).forEach(([s,f])=>{if(s in o){if(o[s]!==f)o[s]=f}else if(f!==null)t.setProperty(s,String(f))})};if(j(i))n.on("transitionend",i);if(ct(i))setTimeout(e,i);else e();return n},get:(r)=>{return t.getPropertyValue(r.toString())},del:(...r)=>{r.forEach((i)=>{t.removeProperty(i.toString())})}}}get submit(){let t=this.e;if("submit"in t)return t.submit();return!1}get tag(){return this.e.tagName.toLowerCase()}get value(){return this.e.value??""}get unload(){return()=>{this.e.remove()}}set append(t){let{ctx:n,oz:r}=Ut(t,pt(this.id));this.e.insertAdjacentHTML("beforeend",n),J.RPS(r)}set appendfirst(t){let{ctx:n,oz:r}=Ut(t,pt(this.id));this.e.insertAdjacentHTML("afterbegin",n),J.RPS(r)}set inner(t){let{ctx:n,oz:r}=Ut(t,pt(this.id));this.e.innerHTML=n,J.RPS(r)}set disabled(t){let n=this.e;if("disabled"in n)n.disabled=t}set id(t){this.e.id=t}set value(t){let n=this.e;n.value=t}}var Ut=(t,n)=>{let{ctx:r,catt:i}=yt(t,n);return{ctx:r,oz:i.OZ}},pt=(t)=>t?`${t}-0`:t;class p extends Gt{constructor(t,n){super(t,n)}add(...t){return this.e.classList.add(...t.map((n)=>n.replace(/[^\w-]/,""))),this}remove(...t){return this.e.classList.remove(...t.map((n)=>n.replace(/[^\w-]/,""))),this}toggle(t,n){let r=typeof t!="string"?t.apply(this):t,i=this.e.classList;return r.split(" ").forEach((o)=>{i.toggle(o,n)}),this}has(t){return this.e.contains(t)}insert(t){return{HTML:(...n)=>{return n.forEach((r)=>{this.e.insertAdjacentHTML(t,r)}),this},element:(...n)=>{return n.forEach((r)=>{this.e.insertAdjacentElement(t,r)}),this},text:function(...n){return n.forEach((r)=>{this.e.insertAdjacentText(t,r)}),this}}}is(t){let n=this.e.classList.value.split(" "),r=this.e.tagName.toLocaleLowerCase(),i=!0,o=!0;if(t.dom)o=t.dom==r?!0:!1;if(t.class)if(Array.isArray(t.class))t.class.forEach((e)=>{i=i?n.includes(e):!1});else i=i?n.includes(t.class):!1;return i&&o}on(t,n,r=!1){let i=!1;if(t.indexOf("touch")>-1)i=!0;return this.e.addEventListener(t,n,{capture:r,passive:i}),this}remove_on(t,n,r=!1){return this.e.removeEventListener(t,n,r),this}timed(t,n=250){return setTimeout(()=>t(this),n),this}animate(t,n,r){let i={duration:300,easing:"ease",fill:"forwards"};if(j(n))r=n;else y(i,n);let o=this.e.animate(t,i);if(r)o.finished.then(r);return this}}function x(t){if(_(t)){let n=document.querySelector(t);if(n)return new p(n,t);return}else return new p(t)}class ht{state=new F(void 0);constructor(){}get element(){return this.state.value?.e}set element(t){this.state.value=new p(t)}get $(){return this.state.value}}var _n=()=>{return new ht};class Et extends Ht{path;args;id;status;lang;import;_data={};static route="/";constructor(t,n={},r,i=200){super();this.path=t;this.args=n;this.id=r;this.status=i}async loader(){if(this.import)try{let t=await this.import;if(t.default)this.import=await t.default({...this.args,...this.data});else this.import=void 0}catch(t){q.e=["import",{error:"loader"}],this.import=void 0}if(this.body){let t=await this.body();return l(t)?t:[t]}if(this.import){let t=this.import;return l(t)?t:[t]}return[]}getHeadAttr(t={},...n){let r=new W;if(S(t))r.head=t;r.id=this.id;let i=r.head;return n.forEach((o)=>{i.map(o)}),an(r,this),i}set data(t){y(this._data,t)}get data(){return this._data}}class Dt extends Et{head(){this.title=`error ${this.status}`}body(){return U("div",{},this.path+" not found...")}}function an(t,n){let{link:r,script:i,meta:o,title:e,base:s,description:f,css:u}=n;if(t.head={title:e,base:s,meta:o,link:r,script:i},f)t.head={meta:[{name:"description",content:f}]};if(u){let h=(l(u)?u:[u]).map((c)=>({rel:"preload stylesheet",href:c,as:"style"}));t.head={link:[...h]}}}function Tn(t){let n=[];if(t?.length){let{href:r,target:i}=t[0],o=x("base");if(o){if(o.attr.get("href")!==r)o.attr.set({href:r,target:i})}else{let e=x(document.createElement("base"));e.attr.set({href:r,target:i}),document.head.append(e.e)}}return n}var xn=new m;async function yn(t,n={},r=!1){let i=ot.value,o={};if(x("link")?.all.forEach((e)=>{let s=x(e),f=s.attr.get("href");if(f){let u=s.attr.get("rt");if(r){let g=xn.get(i);if(g){if(!g.has(f))o[f]=s.unload}else o[f]=s.unload}else if(u){if(u===t)o[f]=s.unload}}}),n&&S(n))for(let e of Z(n)){let s=e.href;if(!(s in o))try{let f=void 0;if(!r){if(f=x(`link[href='${s}']`),f)f.attr.set({rt:t});e.rt=t;let u=xn.init(i,new Set);if(!u.has(s))u.add(s)}if(!f)await Lt(e)}catch(f){q.e=["link error",{error:"yvee @ link"}]}else delete o[s]}return Z(o)}var kn=["charset","name","property","http-equiv"];function En(t){let n={};if(x("meta")?.all.forEach((r)=>{let i=r.attributes;for(let o of kn)if(o in i){let e=i[o].value;n[`${o}_${o==="charset"?"":e}`]=r}}),t)T(t).forEach(([r,i])=>{if(r in n)x(n[r]).attr.set(i),delete n[r];else{let o=x(document.createElement("meta"));o.attr.set(i),document.head.append(o.e)}});return Z(n).map((r)=>x(r).unload)}var cn=new m;async function bn(t,n,r=!1){let i=ot.value,o={};if(x("script[yid]")?.all.forEach((e)=>{let s=x(e),f=s.attr.get("yid");if(f){let u=s.attr.get("rt");if(r){let g=cn.get(i);if(g){if(!g.has(f))o[f]=s.unload}else o[f]=s.unload}else if(u){if(u===t)o[f]=s.unload}}}),n){for(let e of n)if("yid"in e)if(e.yid in o)delete o[e.yid];else try{if(!r){e.rt=t;let s=e.yid,f=cn.init(i,new Set);if(!f.has(s))f.add(s)}await vt(e)}catch(s){q.e=["script error",{error:"yvee @ script"}]}}return Z(o)}var It="";async function $n(t,n,r=!1){let i=[];if(E)return[];let o=t.get("title")??"",{pushState:e}=this.config;if(e){let s=this.path.value;if(It!==s){if(!It.startsWith(s))G(s,o);else if(s===this.base)G(s,o);else G(s,o);It=s}}if(this.isYvee)document.title=o;if(r)document.documentElement.lang=n,i.push(...Tn(t.get("base"))),i.push(...En(t.get("meta")));return i.push(...await yn(this.id,t.get("link"),r)),i.push(...await bn(this.id,t.get("script"),r)),i}function G(t,n){if(E)return;let{pathname:r,hash:i}=window.location,o=r+i;if(t&&o!==t)history.pushState({},n??"",t)}class wt{lang;head="";constructor(t,n){if(this.lang=t,n)this.head=kt(n)}body(t,n,r){return[`<!DOCTYPE html><html lang="${this.lang}">`,`<head>${this.head}</head>`,`<body id="${n??b(5)}"${r?" "+r:""}>${t}</body>`,"</html>"].join("")}}class At{path;args;static route="/";isConnected=M(!1);data={};constructor(t,n={}){this.path=t;this.args=n}open(t){}message(t){}close(t){}error(t){}get connect(){if(this.ws&&this.ws.readyState<=1)return this;return this.ws=new WebSocket(this.path),this.ws.onopen=async(t)=>{this.isConnected.value=!0,await this.open.call(this,t)},this.ws.onmessage=async(t)=>{await this.message.call(this,t)},this.ws.onclose=async(t)=>{this.isConnected.value=!1,await this.close.call(this,t)},this.ws.onerror=async(t)=>{this.isConnected.value=this.ws.readyState<=1,await this.error.call(this,t)},this}get reconnect(){if(this.state>=2)this.connect;return this}get disconnect(){if(this.state<=1)this.ws.close();return this}get state(){return this.ws?.readyState??3}set send(t){this.ws.send(t)}}var C=new m;class Kt{yra;constructor(t){this.yra=t}async load(t){if(!C.has(t)){let[r,i]=await this.yra.loadWSS(t);if(!r)return;let{cls:o,path:e,id:s}=r,f=new o(e,i).connect;return C.set(t,f),f}let n=C.get(t);return n.reconnect,n}unload(t){if(C.has(t)){let n=C.get(t);if(!n)return;n.disconnect,C.delete(t)}}}function vn(t,n,r,i){let{on:o,top:e,topRef:s,...f}=t,u={...o??{},click(g){g.preventDefault();let h=x(this),c=h.path;i.value=r.value,r.value=c;let $=h.hash;if($){let Wt=x($),N=window.scrollY;if(Wt)N+=Wt.rect.top;if(s)N-=s?.value?.e.offsetHeight||0;if(e)if(typeof e==="number")N-=e;else N-=e();window.scrollTo({top:N,behavior:"smooth"}),G(c+$)}else if(i.value===r.value)window.scrollTo({top:h.rect.top||0,behavior:"smooth"}),G(window.location.pathname)}};return U("a",{...f,on:{...u}},...n)}function tr(t,n,r){let{classes:i}=t.config,{on:o,...e}=n,s={...n.on??{},...r&&{popstate(f){let g=f.target.location.pathname;t.path.value=g}},...{element(f){t.mainElement=this}}};return U("div",{...e,...i&&{class:i},on:s},t.root)}var qn=new m;class Bt extends Mt{config;unload=!1;hook;root=M([]);socket;id=b(4);path=M("");lastPath=M("");loading=M(!1);mainElement;A;Main;load;matchPath;isYvee=!1;constructor(t={},n={}){super(t.base??"");this.config=t;if(this.socket=new Kt(this),t.id)this.id=t.id;this.A=(r,...i)=>{if(this.base){if(!r.href.startsWith(this.base))r.href=this._base(r.href)}return vn(r,i,this.path,this.lastPath)},this.Main=(r)=>{if(S(n))if(!r.on)r.on=n;else y(r.on,n);return tr(this,r,this.isYvee)},this.load=async(r,i={})=>{if(this.hook)this.hook();if(r){this.path.value=r,this.lastPath.value=r;try{await this.render(r,404,i),this.hooker()}catch(o){q.e=["render error",{error:"Pager loader"}]}}return this},this.matchPath=(r)=>{let i=this._base(r),o=this.path.value,e=this.base;if(o===i)return!0;else{let s=o.replace(e,""),f=i.replace(e,"");if(f){if(s.startsWith(f))return!0}else if(!o)return!0}return!1}}hooker(){let t={},n={},r=this.path.value;if(this.hook)this.hook();this.hook=lt(async(i)=>{if(n[r]=window.scrollY,t[r]=this.mainElement?.scrollTop??0,(await this.render(i,404)).done){let o=n[i]??0;if(o)window.scrollTo({top:o,behavior:"instant"});let e=t[i]??0;if(e)this.mainElement?.scrollTo({top:e,behavior:"instant"});r=i}},[this.path],{id:"router"})}async class(t,n,r=!1){let[i,o]=await this.getPath(t);if(i&&!r){let{cls:e,id:s}=i;return new e(t,o,s)}else return await nr.call(this,t,404)}async fetch(t){if(t)try{if(t.fetch){let n=await t.fetch();if(V(n)&&S(n))t.data=n}}catch(n){q.e=["class fetch",{error:"fetch"}]}}async processHead(t,n={}){return t?await this.processClassHead(t,n):await this.processDefaultHead(n)}async processClassHead(t,n){if(t.head)await t.head();return t.getHeadAttr(n,this.htmlHead)}async processDefaultHead(t){let n=new W;if(S(t))n.head=t;return n.head.map(this.htmlHead),n.head}async render(t,n=404,r={},i={},o=!0,e=!1){let s=await this.class(t,n??rr(),e);s.data=r,await this.fetch(s);let f=await this.processHead(s,i);if(E)qn.set(this.id,f);if(!s)return{lang:this.lang,heads:f,done:!1};let u=[];if(this.loading.value=!0,this.unload)u=await s.loader();let g=[];if(o)g=await $n.call(this,f,s?.lang||this.lang,this.unload);if(!this.unload)u=await s.loader(),g.forEach((h)=>h());if(this.unload)g.forEach((h)=>h());if(u.length)this.root.value=u;else await this.render(t,n,r,i,o,!0);return this.loading.value=!1,{heads:f,lang:s.lang??this.lang,done:!0}}}async function nr(t,n){let[r,i]=await this.loadError(n??0);if(r){let{cls:o,id:e}=r;return new o(t,i,e,n)}else{let o=new Dt(t,i,b(5));return o.title=`error ${n}`,o}}var ot=M("");class Sn extends Bt{config;isYvee=!0;unload=!0;constructor(t={},n={}){super(t,n);this.config=t;this.path=ot,this.head({meta:[{charset:"utf-8"},{name:"viewport",content:"width=device-width, initial-scale=1.0"}]}),this.load=async(r,i={})=>{if(K)r=ir()||this._base(r??"/");if(this.hook)this.hook();if(r){this.path.value=r,this.lastPath.value=r;try{await this.render(r,404,i),this.hooker()}catch(o){q.e=["render error",{error:"Yvee loader"}]}}return this}}}function rr(){if(K)return parseInt(x('meta[name="error-code"]')?.attr.get("content")??"404");return 404}function ir(){if(K)return x('meta[name="yvee"]')?.attr.get("content")??"/";return""}var or=(t,n,r)=>{let i=[];if(r)switch(r){case 404:i.push({name:"error-code",content:r.toString()});break;default:break}i.push({name:"yvee",content:n}),t.meta=i},er=(t)=>{return(n)=>{t(n)}},jn=(t,n,r=[])=>{let i=n(),o=l(i)?i:[i],e=new Q(t,new Y(t));return o.forEach((s)=>{it(s,o.length,e,r)}),e.OZ.set(e),e.OZ};async function sr(t,n){if(K){await t.load();let r=document.body.id,i=jn(r,n);J.push(i),requestAnimationFrame(()=>{J.stage})}return async({path:r,data:i={},status:o=200,attr:e=""})=>{let{base:s}=t,f={base:[{href:s==="/"?s:`${s}/`,target:"_blank"}],script:[{type:"module",src:"index.js"}]};or(f,r,o),t.path.value=r;let{lang:u,heads:g}=await t.render(r,o,i,f,!1);qn.values().forEach((c)=>{y(g.init("link",{}),c.get("link")??{})});let h=[];return jn(t.id,n,h),new wt(u,g).body(h.join(""),t.id,e)}}var ms=(t,n)=>{return`${t.replace(/\/+$/,"")}/${n.replace(/^\.\/+/,"")}`};export{At as websocket,_n as useRef,un as session,ms as resolvePath,G as pushHistory,hn as observer,q as log,fn as local,On as frag,en as eventStream,U as dom,Et as doc,Lt as cssLoader,Bn as addCSS,nn as __,Sn as Yvee,F as Stateful,M as State,er as Routes,sr as Render,Bt as Pager,k as Meta,R as Dom,x as $};
